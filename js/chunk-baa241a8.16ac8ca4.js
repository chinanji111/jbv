(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-baa241a8"],{"1e94":function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"search"},[a("a-card",[a("div",{staticClass:"table-page-search-wrapper"},[a("a-form",{attrs:{layout:"inline"},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.handleSearch(e)}}},[a("a-row",{attrs:{gutter:24}},[a("a-col",{attrs:{md:6,sm:8}},[a("a-form-item",{attrs:{label:"流程名称",prop:"name"}},[a("a-input",{attrs:{type:"text",placeholder:"请输入",clearable:""},model:{value:t.searchForm.name,callback:function(e){t.$set(t.searchForm,"name",e)},expression:"searchForm.name"}})],1)],1),a("a-col",{attrs:{md:6,sm:8}},[a("a-form-item",{attrs:{label:"标识Key",prop:"name"}},[a("a-input",{attrs:{type:"text",placeholder:"请输入",clearable:""},model:{value:t.searchForm.key,callback:function(e){t.$set(t.searchForm,"key",e)},expression:"searchForm.key"}})],1)],1),a("a-col",{attrs:{md:6,sm:8}},[a("a-form-item",{attrs:{label:"结束时间"}},[a("a-range-picker",{attrs:{format:"YYYY-MM-DD",clearable:""},on:{change:t.selectDateRange},model:{value:t.selectDate,callback:function(e){t.selectDate=e},expression:"selectDate"}})],1)],1),a("span",{staticClass:"table-page-search-submitButtons",staticStyle:{float:"left",overflow:"hidden"}},[a("a-col",{attrs:{md:6,sm:12}},[a("a-button",{attrs:{type:"primary",icon:"search"},on:{click:t.handleSearch}},[t._v("搜索")]),a("a-button",{staticStyle:{"margin-left":"10px"},on:{click:t.handleReset}},[t._v("重置")])],1)],1)],1)],1)],1),a("a-row",[a("a-table",{ref:"table",attrs:{scroll:{x:1680,y:t.innerHeight/2},bordered:"",loading:t.loading,rowKey:"id",dataSource:t.data,pagination:t.ipagination},on:{change:t.handleTableChange}},[a("a-table-column",{attrs:{title:"#",width:50,fixed:"left"},scopedSlots:t._u([{key:"default",fn:function(e,n,s){return[a("span",[t._v(" "+t._s(s+1)+" ")])]}}])}),a("a-table-column",{attrs:{title:"流程实例ID",dataIndex:"id",width:150,fixed:"left"},scopedSlots:t._u([{key:"default",fn:function(e,n,s){return[a("span",[t._v(" "+t._s(e)+" ")])]}}])}),a("a-table-column",{attrs:{title:"流程名称",dataIndex:"name",width:150,fixed:"left"},scopedSlots:t._u([{key:"default",fn:function(e,n,s){return[a("span",[t._v(" "+t._s(e)+" ")])]}}])}),a("a-table-column",{attrs:{title:"申请人",dataIndex:"applyer",ellipsis:!0,width:150,fixed:"left"},scopedSlots:t._u([{key:"default",fn:function(e,n,s){return[a("span",[t._v(" "+t._s(e)+" ")])]}}])}),a("a-table-column",{attrs:{title:"标识Key",dataIndex:"key",width:150},scopedSlots:t._u([{key:"default",fn:function(e,n,s){return[a("span",[t._v(" "+t._s(e)+" ")])]}}])}),a("a-table-column",{attrs:{title:"版本",dataIndex:"version",width:80},scopedSlots:t._u([{key:"default",fn:function(e,n,s){return[a("span",[t._v(" v."+t._s(e)+" ")])]}}])}),a("a-table-column",{key:"result",attrs:{title:"审批结果",dataIndex:"result",width:150,sorter:function(t,e){return t.result-e.result}},scopedSlots:t._u([{key:"default",fn:function(e,n,s){return[4==e?a("span",{staticStyle:{color:"#999999"}},[t._v(" 发起人撤回 ")]):5==e?a("span",{staticStyle:{color:"orange"}},[t._v(" 已删除 ")]):2==e?a("span",{staticStyle:{color:"green"}},[t._v(" 已通过 ")]):3==e?a("span",{staticStyle:{color:"red"}},[t._v(" 已驳回 ")]):a("span",[t._v(" 未知 ")])]}}])}),a("a-table-column",{attrs:{title:"原因详情",dataIndex:"deleteReason",width:150},scopedSlots:t._u([{key:"default",fn:function(t,e,n){return[a("j-ellipsis",{attrs:{value:t,length:10}})]}}])}),a("a-table-column",{key:"duration",attrs:{title:"总耗时",dataIndex:"duration",width:100,sorter:function(t,e){return t.duration-e.duration}},scopedSlots:t._u([{key:"default",fn:function(e,n,s){return[a("span",[t._v(" "+t._s(t.millsToTime(e))+" ")])]}}])}),a("a-table-column",{attrs:{title:"开始时间",dataIndex:"startTime",width:150},scopedSlots:t._u([{key:"default",fn:function(e,n,s){return[a("span",[t._v(" "+t._s(e)+" ")])]}}])}),a("a-table-column",{attrs:{title:"结束时间",dataIndex:"endTime",width:150},scopedSlots:t._u([{key:"default",fn:function(e,n,s){return[a("span",[t._v(" "+t._s(e)+" ")])]}}])}),a("a-table-column",{attrs:{title:"操作",dataIndex:"",width:250,fixed:"right"},scopedSlots:t._u([{key:"default",fn:function(e,n,s){return[a("a",{staticStyle:{color:"green"},attrs:{href:"javascript:void(0);"},on:{click:function(e){return t.history(n)}}},[t._v("审批历史")]),a("a-divider",{attrs:{type:"vertical"}}),a("a",{staticStyle:{color:"blue"},attrs:{href:"javascript:void(0);"},on:{click:function(e){return t.detail(n)}}},[t._v("表单数据")]),a("a-divider",{attrs:{type:"vertical"}}),a("a-popconfirm",{attrs:{title:"确定删除吗?"},on:{confirm:function(){return t.remove(n)}}},[a("a",{staticStyle:{color:"red"}},[t._v("删除")])])]}}])})],1)],1)],1),a("a-modal",{attrs:{title:"审批历史","mask-closable":!1,width:"80%",footer:null},model:{value:t.modalLsVisible,callback:function(e){t.modalLsVisible=e},expression:"modalLsVisible"}},[t.modalLsVisible?a("div",[a(t.historicDetail,{tag:"component",attrs:{procInstId:t.procInstId}})],1):t._e()]),a("a-modal",{attrs:{title:t.lcModa.title,footer:null,maskClosable:!1,width:"80%"},model:{value:t.lcModa.visible,callback:function(e){t.$set(t.lcModa,"visible",e)},expression:"lcModa.visible"}},[t.lcModa.visible?a(t.lcModa.formComponent,{tag:"component",attrs:{disabled:t.lcModa.disabled,processData:t.lcModa.processData,isNew:t.lcModa.isNew},on:{close:function(e){t.lcModa.visible=!1,t.lcModa.disabled=!1}}}):t._e()],1)],1)},s=[],i=a("9ab6"),o=a("b65a"),r={mixins:[o["a"],i["a"]],name:"process-finish-manage",data:function(){return{modalLsVisible:!1,procInstId:"",lcModa:{title:"",disabled:!1,visible:!1,formComponent:null,isNew:!1},openSearch:!0,openTip:!0,loading:!0,selectCount:0,selectList:[],selectDate:null,searchForm:{name:"",key:"",pageNumber:1,pageSize:10},data:[],total:0,deleteId:"",url:{getFinishedProcess:"/actProcessIns/getFinishedProcess",delHistoricIns:"/actProcessIns/delHistoricInsByIds/"}}},methods:{loadData:function(){},init:function(){this.getDataList()},selectDateRange:function(t){this.searchForm.startDate=null,this.searchForm.endDate=null,t[0]&&(this.searchForm.startDate=t[0].format("YYYY-MM-DD")),t[1]&&(this.searchForm.endDate=t[1].format("YYYY-MM-DD"))},getDataList:function(){var t=this;this.loading=!0,this.getAction(this.url.getFinishedProcess,this.searchForm).then((function(e){t.loading=!1,e.success?t.data=e.result:t.$message.error(e.message)}))},handleSearch:function(){this.searchForm.pageNumber=1,this.searchForm.pageSize=10,this.getDataList()},handleReset:function(){this.selectDate=null,this.searchForm={},this.searchForm.pageNumber=1,this.searchForm.pageSize=10,this.getDataList()},handelCancel:function(){this.modalVisible=!1},detail:function(t){t.routeName?(this.lcModa.disabled=!0,this.lcModa.title="查看流程业务信息："+t.name,this.lcModa.formComponent=this.getFormComponent(t.routeName).component,this.lcModa.processData=t,this.lcModa.isNew=!1,this.lcModa.visible=!0):this.$message.warning("该流程信息未配置表单，请联系开发人员！")},history:function(t){t.id?(this.procInstId=t.id,this.modalLsVisible=!0):this.$message.error("流程实例ID不存在")},remove:function(t){var e=this;this.postFormAction(this.url.delHistoricIns+t.id).then((function(t){t.success?(e.$message.success("操作成功"),e.getDataList()):e.$message.error(t.message)}))}},mounted:function(){this.init()},watch:{}},l=r,c=(a("b79a"),a("2877")),d=Object(c["a"])(l,n,s,!1,null,null,null);e["default"]=d.exports},7469:function(t,e,a){},"9ab6":function(t,e,a){"use strict";a.d(e,"a",(function(){return o}));a("ca00"),a("0fea");var n=a("2b0e"),s=a("9fb0"),i=a("d579"),o={components:{JEllipsis:i["default"]},data:function(){return{tokenHeader:{"X-Access-Token":n["default"].ls.get(s["a"])}}},computed:{allFormComponent:function(){return[{text:"示例表单",routeName:"@/views/activiti/form/demoForm",component:function(){return a.e("chunk-71797d8a").then(a.bind(null,"c4c0"))},businessTable:"test_demo"}]},historicDetail:function(){return function(){return a.e("chunk-2d0c06ae").then(a.bind(null,"4260"))}}},methods:{getFormComponent:function(t){return _.find(this.allFormComponent,{routeName:t})||{}},millsToTime:function(t){if(!t)return"";var e=t/1e3;if(e<60)return e.toFixed(0)+" 秒";var a=e/60;if(a<60)return a.toFixed(0)+" 分钟";var n=a/60;if(n<24)return n.toFixed(0)+" 小时";var s=n/24;if(s<30)return s.toFixed(0)+" 天";var i=s/30;if(i<12)return i.toFixed(0)+" 个月";var o=i/12;return o.toFixed(0)+" 年"},handleTableChange:function(t,e,a){Object.keys(a).length>0&&(this.isorter.column=a.field,this.isorter.order="ascend"==a.order?"asc":"desc"),this.ipagination=t},getProcessDefByKey:function(t){var e=null,a=JSON.parse(window.sessionStorage.getItem("newestProcessList"));return a.forEach((function(a){a.processKey===t&&(e=a)})),e}}}},b79a:function(t,e,a){"use strict";var n=a("7469"),s=a.n(n);s.a}}]);