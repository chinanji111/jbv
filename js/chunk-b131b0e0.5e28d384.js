(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-b131b0e0"],{5314:function(e,t,s){"use strict";var a=s("ae44"),i=s.n(a);i.a},"89a2":function(e,t,s){},"9ab6":function(e,t,s){"use strict";s.d(t,"a",(function(){return r}));s("ca00"),s("0fea");var a=s("2b0e"),i=s("9fb0"),n=s("d579"),r={components:{JEllipsis:n["default"]},data:function(){return{tokenHeader:{"X-Access-Token":a["default"].ls.get(i["a"])}}},computed:{allFormComponent:function(){return[{text:"示例表单",routeName:"@/views/activiti/form/demoForm",component:function(){return s.e("chunk-71797d8a").then(s.bind(null,"c4c0"))},businessTable:"test_demo"}]},historicDetail:function(){return function(){return s.e("chunk-2d0c06ae").then(s.bind(null,"4260"))}}},methods:{getFormComponent:function(e){return _.find(this.allFormComponent,{routeName:e})||{}},millsToTime:function(e){if(!e)return"";var t=e/1e3;if(t<60)return t.toFixed(0)+" 秒";var s=t/60;if(s<60)return s.toFixed(0)+" 分钟";var a=s/60;if(a<24)return a.toFixed(0)+" 小时";var i=a/24;if(i<30)return i.toFixed(0)+" 天";var n=i/30;if(n<12)return n.toFixed(0)+" 个月";var r=n/12;return r.toFixed(0)+" 年"},handleTableChange:function(e,t,s){Object.keys(s).length>0&&(this.isorter.column=s.field,this.isorter.order="ascend"==s.order?"asc":"desc"),this.ipagination=e},getProcessDefByKey:function(e){var t=null,s=JSON.parse(window.sessionStorage.getItem("newestProcessList"));return s.forEach((function(s){s.processKey===e&&(t=s)})),t}}}},"9be1":function(e,t,s){"use strict";s.r(t);var a=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"search"},[s("a-card",[s("div",{staticClass:"table-page-search-wrapper"},[s("a-form",{attrs:{layout:"inline"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleSearch(t)}}},[s("a-row",{attrs:{gutter:24}},[s("a-col",{attrs:{md:6,sm:8}},[s("a-form-item",{attrs:{label:"任务名称",prop:"name"}},[s("a-input",{attrs:{type:"text",allowClear:"",placeholder:"请输入"},model:{value:e.searchForm.name,callback:function(t){e.$set(e.searchForm,"name",t)},expression:"searchForm.name"}})],1)],1),s("span",{staticClass:"table-page-search-submitButtons",staticStyle:{float:"left",overflow:"hidden"}},[s("a-col",{attrs:{md:6,sm:12}},[s("a-button",{staticStyle:{left:"10px"},attrs:{type:"primary",icon:"search"},on:{click:e.handleSearch}},[e._v("查询")]),s("a-button",{staticStyle:{"margin-left":"8px",left:"10px"},attrs:{type:"primary",icon:"reload"},on:{click:e.handleReset}},[e._v("重置")])],1)],1)],1)],1)],1),s("a-row",[s("a-table",{ref:"table",attrs:{scroll:e.scroll,bordered:"",loading:e.loading,rowKey:"id",dataSource:e.data,pagination:e.ipagination},on:{change:e.handleTableChange}},[s("a-table-column",{attrs:{title:"#",width:50},scopedSlots:e._u([{key:"default",fn:function(t,a,i){return[s("span",[e._v(" "+e._s(i+1)+" ")])]}}])}),s("a-table-column",{attrs:{title:"任务名称",dataIndex:"name",width:150,align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("span",[e._v(" "+e._s(t)+" ")])]}}])}),s("a-table-column",{attrs:{title:"所属流程",dataIndex:"processName",width:150,align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("span",[e._v(" "+e._s(t)+" ")])]}}])}),s("a-table-column",{attrs:{title:"委托人",dataIndex:"owner",align:"center",width:150},scopedSlots:e._u([{key:"default",fn:function(t){return[s("span",[e._v(" "+e._s(t)+" ")])]}}])}),s("a-table-column",{attrs:{title:"流程发起人",dataIndex:"applyer",width:150,align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("span",[e._v(" "+e._s(t)+" ")])]}}])}),s("a-table-column",{key:"so",attrs:{title:"优先级",dataIndex:"priority",width:110,align:"center",sorter:function(e,t){return e.priority-t.priority}},scopedSlots:e._u([{key:"default",fn:function(t){return[0==t?s("span",{staticStyle:{color:"green"}},[e._v(" 普通 ")]):1==t?s("span",{staticStyle:{color:"orange"}},[e._v(" 重要 ")]):2==t?s("span",{staticStyle:{color:"red"}},[e._v(" 紧急 ")]):s("span",{staticStyle:{color:"#999"}},[e._v(" 无 ")])]}}])}),s("a-table-column",{key:"z",attrs:{title:"状态",dataIndex:"isSuspended",width:100,align:"center",sorter:function(e,t){return Boolean(e.isSuspended)||1-Boolean(t.isSuspended)?0:1}},scopedSlots:e._u([{key:"default",fn:function(t){return[Boolean(t)?e._e():s("span",{staticStyle:{color:"green"}},[e._v(" 已激活 ")]),Boolean(t)?s("span",{staticStyle:{color:"orange"}},[e._v(" 已挂起 ")]):e._e()]}}])}),s("a-table-column",{attrs:{title:"创建时间",dataIndex:"createTime",width:200,align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("span",[e._v(e._s(t))])]}}])}),s("a-table-column",{attrs:{title:"操作",dataIndex:"",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t,a,i){return[s("a",{staticStyle:{color:"blue"},attrs:{href:"javascript:void(0);"},on:{click:function(t){return e.detail(a)}}},[e._v("查看并处理")]),s("a-divider",{attrs:{type:"vertical"}}),Boolean(a.isSuspended)?s("span",{staticStyle:{cursor:"no-drop",color:"#999999"},attrs:{title:"流程已被挂起，无法操作！"}},[e._v("\n              查看并处理 "),s("a-divider",{attrs:{type:"vertical"}}),e._v("\n              委托他人代办 "),s("a-divider",{attrs:{type:"vertical"}})],1):s("span",[s("a",{staticStyle:{color:"#00A0E9"},attrs:{href:"javascript:void(0);"},on:{click:function(t){return e.delegateTask(a)}}},[e._v("委托他人代办")]),s("a-divider",{attrs:{type:"vertical"}})],1),s("a",{staticStyle:{color:"#217dbb"},attrs:{href:"javascript:void(0);"},on:{click:function(t){return e.history(a)}}},[e._v("历史")])]}}])})],1)],1)],1),s("a-modal",{attrs:{title:"审批历史","mask-closable":!1,width:"80%",footer:null},model:{value:e.modalLsVisible,callback:function(t){e.modalLsVisible=t},expression:"modalLsVisible"}},[e.modalLsVisible?s("div",[s(e.historicDetail,{tag:"component",attrs:{procInstId:e.procInstId}})],1):e._e()]),s("a-modal",{attrs:{title:e.lcModa.title,footer:null,maskClosable:!1,width:"80%"},model:{value:e.lcModa.visible,callback:function(t){e.$set(e.lcModa,"visible",t)},expression:"lcModa.visible"}},[e.lcModa.visible?s(e.lcModa.formComponent,{tag:"component",attrs:{disabled:e.lcModa.disabled,processData:e.lcModa.processData,isNew:e.lcModa.isNew,task:!0},on:{passTask:function(){return e.passTask(e.lcModa.processData)},backTask:function(){return e.backTask(e.lcModa.processData)},close:function(t){e.lcModa.visible=!1,e.lcModa.disabled=!1}}}):e._e()],1),s("a-modal",{attrs:{title:e.modalTaskTitle,"mask-closable":!1,width:500},model:{value:e.modalTaskVisible,callback:function(t){e.modalTaskVisible=t},expression:"modalTaskVisible"}},[e.modalTaskVisible?s("div",[s("a-form",{ref:"form",attrs:{model:e.form,"label-width":85,rules:e.formValidate}},[s("a-form-item",{attrs:{label:"审批意见",prop:"reason"}},[s("a-input",{attrs:{type:"textarea",rows:4},model:{value:e.form.comment,callback:function(t){e.$set(e.form,"comment",t)},expression:"form.comment"}})],1),s("a-form-item",{directives:[{name:"show",rawName:"v-show",value:e.showAssign,expression:"showAssign"}],attrs:{label:"下一审批人",prop:"assignees",error:e.error}},[s("a-select",{attrs:{placeholder:"请选择",allowClear:"",mode:"multiple",loading:e.userLoading},model:{value:e.form.assignees,callback:function(t){e.$set(e.form,"assignees",t)},expression:"form.assignees"}},e._l(e.assigneeList,(function(t,a){return s("a-select-option",{key:a,attrs:{value:t.username}},[e._v(e._s(t.realname))])})),1)],1),s("a-form-item",{directives:[{name:"show",rawName:"v-show",value:e.isGateway,expression:"isGateway"}],attrs:{label:"下一审批人"}},[s("span",[e._v("分支网关处暂不支持自定义选择下一审批人，将发送给下一节点所有人")])]),s("div",{directives:[{name:"show",rawName:"v-show",value:1==e.form.type,expression:"form.type==1"}]},[s("a-form-item",{attrs:{label:"驳回至"}},[s("a-select",{attrs:{loading:e.backLoading},on:{change:e.changeBackTask},model:{value:e.form.backTaskKey,callback:function(t){e.$set(e.form,"backTaskKey",t)},expression:"form.backTaskKey"}},e._l(e.backList,(function(t,a){return s("a-select-option",{key:a,attrs:{value:t.key}},[e._v(e._s(t.name))])})),1)],1),s("a-form-item",{directives:[{name:"show",rawName:"v-show",value:-1!=e.form.backTaskKey,expression:"form.backTaskKey!=-1"}],attrs:{label:"指定原节点审批人",prop:"assignees",error:e.error}},[s("a-select",{attrs:{placeholder:"请选择",allowClear:"",mode:"multiple",loading:e.userLoading},model:{value:e.form.assignees,callback:function(t){e.$set(e.form,"assignees",t)},expression:"form.assignees"}},e._l(e.assigneeList,(function(t,a){return s("a-select-option",{key:a,attrs:{value:t.username}},[e._v(e._s(t.realname))])})),1)],1)],1),s("a-form-item",{directives:[{name:"show",rawName:"v-show",value:2==e.form.type,expression:"form.type==2"}],attrs:{label:"选择委托人",prop:"userId",error:e.error}},[s("JSelectUserByDep",{attrs:{multi:!1},model:{value:e.form.userId,callback:function(t){e.$set(e.form,"userId",t)},expression:"form.userId"}})],1),s("a-form-item",{attrs:{label:"消息通知"}},[s("a-checkbox",{model:{value:e.form.sendMessage,callback:function(t){e.$set(e.form,"sendMessage",t)},expression:"form.sendMessage"}},[e._v("站内消息通知")]),s("a-checkbox",{attrs:{disabled:""},model:{value:e.form.sendSms,callback:function(t){e.$set(e.form,"sendSms",t)},expression:"form.sendSms"}},[e._v("短信通知")]),s("a-checkbox",{attrs:{disabled:""},model:{value:e.form.sendEmail,callback:function(t){e.$set(e.form,"sendEmail",t)},expression:"form.sendEmail"}},[e._v("邮件通知")])],1)],1)],1):e._e(),s("div",{attrs:{slot:"footer"},slot:"footer"},[s("a-button",{attrs:{type:"text"},on:{click:function(t){e.modalTaskVisible=!1}}},[e._v("取消")]),s("a-button",{attrs:{type:"primary",loading:e.submitLoading},on:{click:e.handelSubmit}},[e._v("提交")])],1)])],1)},i=[],n=s("b65a"),r=s("9ab6"),o=s("c14a"),l={name:"todo-manage",mixins:[r["a"],n["a"]],components:{JSelectUserByDep:o["default"]},data:function(){return{openSearch:!0,openTip:!0,loading:!0,modalTaskVisible:!1,userLoading:!1,backLoading:!1,selectCount:0,selectList:[],assigneeList:[],backList:[{key:"-1",name:"发起人"}],error:"",showAssign:!1,searchForm:{name:""},modalTaskTitle:"",modalTitle:"",form:{id:"",userId:"",procInstId:"",comment:"",type:0,assignees:[],backTaskKey:"-1",sendMessage:!0,sendSms:!1,sendEmail:!1},formValidate:{},submitLoading:!1,data:[],total:0,dictPriority:[],isGateway:!1,lcModa:{title:"",disabled:!1,visible:!1,formComponent:null,isNew:!1},url:{todoList:"/actTask/todoList",pass:"/actTask/pass",back:"/actTask/back",backToTask:"/actTask/backToTask",delegate:"/actTask/delegate",getNextNode:"/activiti_process/getNextNode",getNode:"/activiti_process/getNode/",getBackList:"/actTask/getBackList/",passAll:"/actTask/passAll/",backAll:"/actTask/backAll/"},modalLsVisible:!1,procInstId:""}},mounted:function(){this.init()},methods:{init:function(){this.getDataList()},loadData:function(){},getDataList:function(){var e=this;this.loading=!0,this.getAction(this.url.todoList,this.searchForm).then((function(t){e.loading=!1,t.success&&(e.data=t.result||[],e.total=e.data.leading)}))},handleTableChange:function(e,t,s){Object.keys(s).length>0&&(this.isorter.column=s.field,this.isorter.order="ascend"==s.order?"asc":"desc"),this.ipagination=e},handleSearch:function(){this.getDataList()},handleReset:function(){this.searchForm={},this.getDataList()},showSelect:function(e){this.selectList=e,this.selectCount=e.length},clearSelectAll:function(){this.$refs.table.selectAll(!1)},handelSubmit:function(){var e=this;this.submitLoading=!0;var t=Object.assign({},this.form);if(t.assignees=t.assignees.join(","),0==t.type){if(this.showAssign&&t.assignees.length<1)return this.$message.error("请至少选择一个审批人"),void(this.submitLoading=!1);this.error="",this.postFormAction(this.url.pass,t).then((function(t){e.submitLoading=!1,t.success&&(e.lcModa.visible=!1,e.$message.success("操作成功"),e.modalTaskVisible=!1,e.getDataList())}))}else if(1==t.type)if("-1"==t.backTaskKey)this.postFormAction(this.url.back,t).then((function(t){e.submitLoading=!1,t.success&&(e.lcModa.visible=!1,e.$message.success("操作成功"),e.modalTaskVisible=!1,e.getDataList())}));else{if("-1"!=t.backTaskKey&&t.assignees.length<1)return this.$message.error("请至少选择一个审批人"),void(this.submitLoading=!1);this.error="",this.postFormAction(this.url.backToTask,t).then((function(t){e.submitLoading=!1,t.success&&(e.lcModa.visible=!1,e.$message.success("操作成功"),e.modalTaskVisible=!1,e.getDataList())}))}else if(2==t.type){if(!t.userId)return this.$message.error("请选择一委托人"),void(this.submitLoading=!1);this.error="",this.postFormAction(this.url.delegate,t).then((function(t){e.submitLoading=!1,t.success&&(e.$message.success("操作成功"),e.modalTaskVisible=!1,e.getDataList())}))}},detail:function(e){e.routeName?(this.lcModa.disabled=!0,this.lcModa.title="查看流程业务信息："+e.processName,this.lcModa.formComponent=this.getFormComponent(e.routeName).component,this.lcModa.processData=e,this.lcModa.isNew=!1,this.lcModa.visible=!0):this.$message.warning("该流程信息未配置表单，请联系开发人员！")},passTask:function(e){var t=this;this.modalTaskTitle="审批通过",this.form.id=e.id,this.form.procInstId=e.procInstId,this.form.priority=e.priority,this.form.type=0,this.modalTaskVisible=!0,this.userLoading=!0,this.getAction(this.url.getNextNode,{procDefId:e.procDefId,currActId:e.key}).then((function(e){if(t.userLoading=!1,e.success){if(4==e.result.type)return t.isGateway=!0,t.showAssign=!1,void(t.error="");if(t.isGateway=!1,e.result.users&&e.result.users.length>0){t.error="",t.assigneeList=e.result.users;var s=[];e.result.users.forEach((function(e){s.push(e.username)})),t.form.assignees=s,t.showAssign=!0}else t.form.assignees=[],t.showAssign=!1}}))},changeBackTask:function(e){var t=this;"-1"!=e&&(this.userLoading=!0,this.getAction(this.url.getNode+e).then((function(e){if(t.userLoading=!1,e.success&&e.result.users&&e.result.users.length>0){t.assigneeList=e.result.users;var s=[];e.result.users.forEach((function(e){s.push(e.username)})),t.form.assignees=s}})))},backTask:function(e){var t=this;this.modalTaskTitle="审批驳回",this.form.id=e.id,this.form.procInstId=e.procInstId,this.form.procDefId=e.procDefId,this.form.priority=e.priority,this.form.type=1,this.showAssign=!1,this.modalTaskVisible=!0,this.backList=[{key:"-1",name:"发起人"}],this.form.backTaskKey="-1",this.backLoading=!0,this.getAction(this.url.getBackList+e.procInstId).then((function(e){t.backLoading=!1,e.success&&e.result.forEach((function(e){t.backList.push(e)}))}))},delegateTask:function(e){this.modalTaskTitle="委托他人代办",this.form.id=e.id,this.form.procInstId=e.procInstId,this.form.type=2,this.showAssign=!1,this.modalTaskVisible=!0},history:function(e){e.procInstId?(this.procInstId=e.procInstId,this.modalLsVisible=!0):this.$message.error("流程实例ID不存在")},passAll:function(){var e=this;this.selectCount<=0?this.$message.warning("您还未选择要通过的数据"):(this.modalVisible=!0,this.$confirm({title:"确认通过",content:"您确认要通过所选的 "+this.selectCount+" 条数据? 注意：将默认分配给节点设定的所有可审批用户",loading:!0,onOk:function(){var t="";e.selectList.forEach((function(e){t+=e.id+","})),t=t.substring(0,t.length-1),e.postFormAction(e.url.passAll,{ids:t}).then((function(t){t.success&&(e.$message.success("操作成功"),e.modalVisible=!1,e.clearSelectAll(),e.getDataList())}))}}))},backAll:function(){var e=this;this.selectCount<=0?this.$message.warning("您还未选择要驳回的数据"):(this.modalVisible=!0,this.$confirm({title:"确认驳回",content:"您确认要驳回所选的 "+this.selectCount+" 条数据? 注意：所有流程将驳回至发起人",loading:!0,onOk:function(){var t="";e.selectList.forEach((function(e){t+=e.procInstId+","})),t=t.substring(0,t.length-1),e.postFormAction(e.url.backAll,{procInstIds:t}).then((function(t){t.success&&(e.$message.success("操作成功"),e.modalVisible=!1,e.clearSelectAll(),e.getDataList())}))}}))}}},c=l,d=(s("d016"),s("2877")),u=Object(d["a"])(c,a,i,!1,null,null,null);t["default"]=u.exports},a505:function(e,t,s){"use strict";s.r(t);var a=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("j-modal",{staticStyle:{top:"50px"},attrs:{width:e.modalWidth,visible:e.visible,title:e.title,switchFullscreen:"",cancelText:"关闭"},on:{ok:e.handleSubmit,cancel:e.close}},[s("a-row",{staticStyle:{"background-color":"#ececec",padding:"10px",margin:"-10px"},attrs:{gutter:10}},[s("a-col",{attrs:{md:6,sm:24}},[s("a-card",{attrs:{bordered:!1}},[s("a-directory-tree",{attrs:{selectable:"",selectedKeys:e.selectedDepIds,checkStrictly:!0,dropdownStyle:{maxHeight:"200px",overflow:"auto"},treeData:e.departTree,expandAction:!1,expandedKeys:e.expandedKeys},on:{"update:expandedKeys":function(t){e.expandedKeys=t},"update:expanded-keys":function(t){e.expandedKeys=t},select:e.onDepSelect}})],1)],1),s("a-col",{attrs:{md:18,sm:24}},[s("a-card",{attrs:{bordered:!1}},[e._v("\n        用户账号:\n        "),s("a-input-search",{style:{width:"150px",marginBottom:"15px"},attrs:{placeholder:"请输入账号"},on:{search:e.onSearch},model:{value:e.queryParam.username,callback:function(t){e.$set(e.queryParam,"username",t)},expression:"queryParam.username"}}),s("a-button",{staticStyle:{"margin-left":"20px"},attrs:{icon:"redo"},on:{click:function(t){return e.searchReset(1)}}},[e._v("重置")]),s("a-table",{ref:"table",attrs:{scroll:e.scrollTrigger,size:"middle",rowKey:"id",columns:e.columns,dataSource:e.dataSource,pagination:e.ipagination,rowSelection:{selectedRowKeys:e.selectedRowKeys,onChange:e.onSelectChange,type:e.getType},loading:e.loading},on:{change:e.handleTableChange}})],1)],1)],1)],1)},i=[],n=s("a34a"),r=s.n(n),o=s("ca00"),l=s("4ec3");function c(e,t,s,a,i,n,r){try{var o=e[n](r),l=o.value}catch(c){return void s(c)}o.done?t(l):Promise.resolve(l).then(a,i)}function d(e){return function(){var t=this,s=arguments;return new Promise((function(a,i){var n=e.apply(t,s);function r(e){c(n,a,i,r,o,"next",e)}function o(e){c(n,a,i,r,o,"throw",e)}r(void 0)}))}}var u={name:"JSelectUserByDepModal",components:{},props:["modalWidth","multi","userIds"],data:function(){return{queryParam:{username:""},columns:[{title:"用户账号",align:"center",dataIndex:"username"},{title:"用户姓名",align:"center",dataIndex:"realname"},{title:"性别",align:"center",dataIndex:"sex",customRender:function(e){return 1===e?"男":2===e?"女":e}},{title:"手机",align:"center",dataIndex:"phone"},{title:"部门",align:"center",dataIndex:"orgCodeTxt"}],scrollTrigger:{},dataSource:[],selectedRowKeys:[],selectUserRows:[],selectUserIds:[],title:"根据部门选择用户",ipagination:{current:1,pageSize:10,pageSizeOptions:["10","20","30"],showTotal:function(e,t){return t[0]+"-"+t[1]+" 共"+e+"条"},showQuickJumper:!0,showSizeChanger:!0,total:0},isorter:{column:"createTime",order:"desc"},selectedDepIds:[],departTree:[],visible:!1,form:this.$form.createForm(this),loading:!1,expandedKeys:[]}},computed:{getType:function(){return 1==this.multi?"checkbox":"radio"}},watch:{userIds:{immediate:!0,handler:function(){this.initUserNames()}}},created:function(){this.resetScreenSize(),this.loadData()},methods:{initUserNames:function(){var e=this;if(this.userIds){var t=this.userIds.split(",")+",";Object(l["A"])({username:t,pageNo:1,pageSize:t.length}).then((function(t){if(t.success){var s=[],a=[];t.result.records.forEach((function(e){a.push(e["realname"]),s.push(e["id"])})),e.selectedRowKeys=s,e.$emit("initComp",a.join(","))}}))}else this.$emit("initComp","")},loadData:function(){var e=d(r.a.mark((function e(t){var s,a=this;return r.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(1===t&&(this.ipagination.current=1),!(this.selectedDepIds&&this.selectedDepIds.length>0)){e.next=6;break}return e.next=4,this.initQueryUserByDepId(this.selectedDepIds);case 4:e.next=10;break;case 6:return this.loading=!0,s=this.getQueryParams(),e.next=10,Object(l["A"])(s).then((function(e){e.success&&(a.dataSource=e.result.records,a.ipagination.total=e.result.total)})).finally((function(){a.loading=!1}));case 10:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}(),resetScreenSize:function(){var e=document.body.clientWidth;this.scrollTrigger=e<500?{x:800}:{}},showModal:function(){this.visible=!0,this.queryDepartTree(),this.initUserNames(),this.loadData(),this.form.resetFields()},getQueryParams:function(){var e=Object.assign({},this.queryParam,this.isorter);return e.field=this.getQueryField(),e.pageNo=this.ipagination.current,e.pageSize=this.ipagination.pageSize,Object(o["d"])(e)},getQueryField:function(){for(var e="id,",t=0;t<this.columns.length;t++)e+=","+this.columns[t].dataIndex;return e},searchReset:function(e){var t=this;0!==e&&(t.queryParam={},t.loadData(1)),t.selectedRowKeys=[],t.selectUserIds=[],t.selectedDepIds=[]},close:function(){this.searchReset(0),this.visible=!1},handleTableChange:function(e,t,s){Object.keys(s).length>0&&(this.isorter.column=s.field,this.isorter.order="ascend"===s.order?"asc":"desc"),this.ipagination=e,this.loadData()},handleSubmit:function(){var e=this;this.getSelectUserRows(),e.$emit("ok",e.selectUserRows,e.selectUserIds),e.searchReset(0),e.close()},getSelectUserRows:function(e){var t=this.dataSource,s="";this.selectUserRows=[];for(var a=0,i=t.length;a<i;a++)this.selectedRowKeys.includes(t[a].id)&&(this.selectUserRows.push(t[a]),s=s+","+t[a].username);this.selectUserIds=s.substring(1)},onDepSelect:function(e){null!=e[0]&&(this.initQueryUserByDepId(e),this.selectedDepIds[0]!==e[0]&&(this.selectedDepIds=[e[0]]))},onSelectChange:function(e,t){this.selectedRowKeys=e,this.selectionRows=t},onSearch:function(){this.loadData(1)},initQueryUserByDepId:function(e){var t=this;return this.loading=!0,Object(l["N"])({id:e.toString()}).then((function(e){e.success&&(t.dataSource=e.result,t.ipagination.total=e.result.length)})).finally((function(){t.loading=!1}))},queryDepartTree:function(){var e=this;Object(l["D"])().then((function(t){t.success&&(e.departTree=t.result,e.expandedKeys=e.departTree.map((function(e){return e.id})))}))},modalFormOk:function(){this.loadData()}}},m=u,h=(s("5314"),s("2877")),f=Object(h["a"])(m,a,i,!1,null,"1461a8eb",null);t["default"]=f.exports},ae44:function(e,t,s){},c14a:function(e,t,s){"use strict";s.r(t);var a=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("a-input-search",{attrs:{placeholder:"请先选择用户",readOnly:"",unselectable:"on"},on:{search:e.onSearchDepUser},model:{value:e.userNames,callback:function(t){e.userNames=t},expression:"userNames"}},[s("a-button",{attrs:{slot:"enterButton",disabled:e.disabled},slot:"enterButton"},[e._v("选择用户")])],1),s("j-select-user-by-dep-modal",{ref:"selectModal",attrs:{"modal-width":e.modalWidth,multi:e.multi,"user-ids":e.value},on:{ok:e.selectOK,initComp:e.initComp}})],1)},i=[],n=s("a505"),r={name:"JSelectUserByDep",components:{JSelectUserByDepModal:n["default"]},props:{modalWidth:{type:Number,default:1250,required:!1},value:{type:String,required:!1},disabled:{type:Boolean,required:!1,default:!1},multi:{type:Boolean,default:!0,required:!1}},data:function(){return{userIds:"",userNames:""}},mounted:function(){this.userIds=this.value},watch:{value:function(e){this.userIds=e}},model:{prop:"value",event:"change"},methods:{initComp:function(e){this.userNames=e},onSearchDepUser:function(){this.$refs.selectModal.showModal()},selectOK:function(e,t){if(e){var s="",a=!0,i=!1,n=void 0;try{for(var r,o=e[Symbol.iterator]();!(a=(r=o.next()).done);a=!0){var l=r.value;s+=","+l.realname}}catch(c){i=!0,n=c}finally{try{a||null==o.return||o.return()}finally{if(i)throw n}}this.userNames=s.substring(1),this.userIds=t}else this.userNames="",this.userIds="";this.$emit("change",this.userIds)}}},o=r,l=s("2877"),c=Object(l["a"])(o,a,i,!1,null,"bd3f15c8",null);t["default"]=c.exports},d016:function(e,t,s){"use strict";var a=s("89a2"),i=s.n(a);i.a}}]);