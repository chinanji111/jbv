(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-1e8530b0","chunk-f46ddf66","chunk-2d0c06ae"],{2800:function(t,e,a){},3010:function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("a-card",{attrs:{bordered:!1}},[a("a-input-search",{staticStyle:{"margin-bottom":"10px","margin-right":"10px",width:"200px"},attrs:{placeholder:"输入流程名称"},on:{search:t.onSearchProcess},model:{value:t.searchProcessKey,callback:function(e){t.searchProcessKey=e},expression:"searchProcessKey"}}),a("a-button",{attrs:{type:"primary"},on:{click:function(e){return t.onSearchProcess(t.searchProcessKey)}}},[t._v("查询")]),a("a-button",{on:{click:function(e){return t.onSearchProcess("")}}},[t._v("重置")]),a("a-button",{staticStyle:{float:"right"},attrs:{type:"primary"},on:{click:t.handleToApplyList}},[t._v("前往我的申请列表")]),0==t.activeKeyAll.length?a("a-empty",{attrs:{description:"无流程可供选择"}}):a("div",[a("a-collapse",{model:{value:t.activeKey,callback:function(e){t.activeKey=e},expression:"activeKey"}},t._l(t.activeKeyAll,(function(e,n){return a("a-collapse-panel",{key:e,attrs:{header:t.filterDictText(t.dictOptions,e)||"未分类"}},[a("a-list",{attrs:{grid:{gutter:10,column:4},dataSource:t.processDataMap[e]},scopedSlots:t._u([{key:"renderItem",fn:function(e){return a("a-list-item",{},[a("a-card",[a("div",{attrs:{slot:"title"},slot:"title"},[a("a-row",[a("a-col",{attrs:{span:"12",title:e.name}},[t._v(t._s(e.name)+" ")]),a("a-col",{staticStyle:{"text-align":"right"},attrs:{span:"12"}},[a("a",{attrs:{href:"javascript:void (0)"},on:{click:function(a){return t.chooseProcess(e)}}},[t._v("发起申请")])])],1)],1),a("b",[t._v("版本：")]),t._v("v."+t._s(e.version)+"\n                "),a("br"),a("b",[t._v("说明：")]),t._v(t._s(e.description)+"\n              ")])],1)}}],null,!0)})],1)})),1)],1),a("a-modal",{attrs:{destroyOnClose:!0,title:t.lcModa.title,footer:null,maskClosable:!1,width:"80%"},model:{value:t.lcModa.visible,callback:function(e){t.$set(t.lcModa,"visible",e)},expression:"lcModa.visible"}},[t.lcModa.visible?a(t.lcModa.formComponent,{tag:"component",attrs:{disabled:t.lcModa.disabled,processData:t.lcModa.processData,isNew:t.lcModa.isNew},on:{afterSubmit:t.afterSub,close:function(e){t.lcModa.visible=!1,t.lcModa.disabled=!1}}}):t._e()],1)],1)},s=[],i=a("9ab6"),o=a("d579"),r=a("b098"),c=a("89f2"),l=a("4260"),d={name:"applyHome",mixins:[i["a"]],components:{JEllipsis:o["default"],JTreeSelect:r["default"],historicDetail:l["default"]},data:function(){return{description:"所有",dictOptions:[],url:{getProcessDataList:"/activiti_process/listData",getFirstNode:"/actProcessIns/getFirstNode",applyBusiness:"/actBusiness/apply"},queryParam:{createTimeRange:[],keyWord:""},labelCol:{xs:{span:4},sm:{span:4}},wrapperCol:{xs:{span:20},sm:{span:20}},processModalVisible:null,activeKeyAll:[],activeKey:[],processDataMap:{},searchProcessKey:null,addApplyLoading:!1,lcModa:{title:"",disabled:!1,visible:!1,formComponent:null,isNew:!1}}},computed:{},mounted:function(){this.initDictConfig(),this.getProcessList()},methods:{initDictConfig:function(){var t=this;Object(c["d"])("bpm_process_type").then((function(e){e.success&&(t.dictOptions=e.result)}))},filterDictText:function(t,e){if(t instanceof Array){var a=!0,n=!1,s=void 0;try{for(var i,o=t[Symbol.iterator]();!(a=(i=o.next()).done);a=!0){var r=i.value;if(e===r.value)return r.text}}catch(c){n=!0,s=c}finally{try{a||null==o.return||o.return()}finally{if(n)throw s}}}return e||"null"==e?"":e},getProcessList:function(){var t=this;this.addApplyLoading=!0,this.getAction(this.url.getProcessDataList,{status:1,roles:!0}).then((function(e){if(t.activeKeyAll=[],e.success){var a=e.result||[];if(a.length>0){var n=t.searchProcessKey;for(var s in n&&(a=_.filter(a,(function(t){return t.name.indexOf(n)>-1}))),t.processDataMap=_.groupBy(a,"categoryId"),t.processDataMap)t.activeKeyAll.push(s);t.activeKey=t.activeKeyAll}t.processModalVisible=!0}else t.$message.warning(e.message)})).finally((function(){return t.addApplyLoading=!1}))},onSearchProcess:function(t){this.searchProcessKey=t,this.getProcessList()},chooseProcess:function(t){t.routeName?(this.lcModa.formComponent=this.getFormComponent(t.routeName).component,this.lcModa.title="发起流程："+t.name,this.lcModa.isNew=!0,this.lcModa.processData=t,this.lcModa.visible=!0):this.$message.warning("该流程信息未配置表单，请联系开发人员！")},afterSub:function(t){this.lcModa.visible=!1,this.$message("请前往我的申请列表提交审批！")},handleToApplyList:function(){this.$router.push({path:"/activiti/applyList"})}}},u=d,p=(a("a47d"),a("2877")),f=Object(p["a"])(u,n,s,!1,null,"a26a692e",null);e["default"]=f.exports},4260:function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"search"},[a("a-card",{staticStyle:{"margin-bottom":"10px"}},[a("p",{attrs:{slot:"title"},slot:"title"},[a("span",[t._v("流程审批进度历史")])]),a("a-row",{staticStyle:{position:"relative"}},[a("a-table",{ref:"table",attrs:{loading:t.loading,rowKey:"id",dataSource:t.data,pagination:!1}},[a("a-table-column",{attrs:{title:"#",width:"50"},scopedSlots:t._u([{key:"default",fn:function(e,n,s){return[a("span",[t._v(" "+t._s(s+1)+" ")])]}}])}),a("a-table-column",{attrs:{title:"任务名称",dataIndex:"name",width:"150",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(" "+t._s(e)+" ")])]}}])}),a("a-table-column",{attrs:{title:"处理人",dataIndex:"assignees",width:"150",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[e?a("div",t._l(e,(function(e){return a("span",[e.isExecutor?a("span",{staticStyle:{color:"#00DB00"}},[t._v(t._s(e.username)+" ")]):a("span",{staticStyle:{color:"#999"}},[t._v(t._s(e.username)+" ")])])})),0):t._e()]}}])}),a("a-table-column",{attrs:{title:"审批操作",dataIndex:"deleteReason",width:"150",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.toString().indexOf("通过")>-1?a("span",{staticStyle:{color:"#00DB00"}},[t._v(t._s(e))]):e.toString().indexOf("驳回")>-1?a("span",{staticStyle:{color:"red"}},[t._v(t._s(e))]):a("span",[t._v(t._s(e))])]}}])}),a("a-table-column",{attrs:{title:"审批意见",dataIndex:"comment",width:"150",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(e))])]}}])}),a("a-table-column",{attrs:{title:"耗时",dataIndex:"duration",width:"150",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(t.millsToTime(e)))])]}}])}),a("a-table-column",{attrs:{title:"创建时间",dataIndex:"createTime",width:"150",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(e))])]}}])}),a("a-table-column",{attrs:{title:"完成时间",dataIndex:"endTime",width:"150",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(e))])]}}])}),a("a-table-column",{key:"aaa",attrs:{title:"状态",dataIndex:"endTime",width:"150",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[e?a("span",{staticStyle:{color:"blue"}},[t._v("已办理")]):a("span",{staticStyle:{color:"#999999"}},[t._v("待处理")])]}}])})],1)],1)],1),a("a-tabs",{attrs:{type:"card"},on:{change:t.callback}},[a("a-tab-pane",{key:"1",attrs:{tab:"实时流程图"}},[a("a-card",[a("a-row",{staticStyle:{position:"relative"}},[a("img",{attrs:{src:t.imgUrl}}),t.loadingImg?a("a-spin",{attrs:{size:"large",fix:""}}):t._e()],1)],1)],1),t.lcModa?a("a-tab-pane",{key:"2",attrs:{tab:"表单数据"}},[a("a-card",[a(t.lcModa.formComponent,{tag:"component",attrs:{disabled:t.lcModa.disabled,processData:t.lcModa.processData,isNew:t.lcModa.isNew,task:t.lcModa.isTask},on:{afterSubmit:t.afterSub,passTask:function(e){return t.pass(t.lcModa.processData)},backTask:function(e){return t.back(t.lcModa.processData)},close:function(e){t.lcModa.visible=!1,t.lcModa.disabled=!1}}})],1)],1):t._e()],1)],1)},s=[],i=a("b65a"),o=a("9ab6"),r={name:"historic_detail",mixins:[o["a"],i["a"]],props:{procInstId:{type:String,default:"",required:!0},lcModa:{type:Object,required:!1}},data:function(){return{url:{historicFlow:"/actTask/historicFlow/",getHighlightImg:"".concat(window._CONFIG["domianURL"],"/activiti/models/getHighlightImg/")},type:0,loading:!1,loadingImg:!1,data:[],id:"",imgUrl:"",backRoute:""}},created:function(){this.init()},watch:{procInstId:function(t,e){this.init()}},methods:{loadData:function(){},init:function(){this.id=this.procInstId,this.imgUrl=this.url.getHighlightImg+this.id+"?time="+new Date,this.getDataList()},getDataList:function(){var t=this;this.loading=!0,this.getAction(this.url.historicFlow+this.id).then((function(e){t.loading=!1,e.success?(t.data=e.result,e.result&&0!=e.result.length||t.$message.info("未找到该记录审批历史数据,历史数据可能已被删除")):t.$message.error(e.message)}))},handleTableChange:function(t,e,a){Object.keys(a).length>0&&(this.isorter.column=a.field,this.isorter.order="ascend"==a.order?"asc":"desc"),this.ipagination=t},callback:function(t){},afterSub:function(){},pass:function(t){this.$emit("passTask",t)},back:function(t){this.$emit("backTask",t)}}},c=r,l=a("2877"),d=Object(l["a"])(c,n,s,!1,null,null,null);e["default"]=d.exports},"9ab6":function(t,e,a){"use strict";a.d(e,"a",(function(){return o}));a("ca00"),a("0fea");var n=a("2b0e"),s=a("9fb0"),i=a("d579"),o={components:{JEllipsis:i["default"]},data:function(){return{tokenHeader:{"X-Access-Token":n["default"].ls.get(s["a"])}}},computed:{allFormComponent:function(){return[{text:"示例表单",routeName:"@/views/activiti/form/demoForm",component:function(){return a.e("chunk-71797d8a").then(a.bind(null,"c4c0"))},businessTable:"test_demo"}]},historicDetail:function(){return function(){return a.e("chunk-2d0c06ae").then(a.bind(null,"4260"))}}},methods:{getFormComponent:function(t){return _.find(this.allFormComponent,{routeName:t})||{}},millsToTime:function(t){if(!t)return"";var e=t/1e3;if(e<60)return e.toFixed(0)+" 秒";var a=e/60;if(a<60)return a.toFixed(0)+" 分钟";var n=a/60;if(n<24)return n.toFixed(0)+" 小时";var s=n/24;if(s<30)return s.toFixed(0)+" 天";var i=s/30;if(i<12)return i.toFixed(0)+" 个月";var o=i/12;return o.toFixed(0)+" 年"},handleTableChange:function(t,e,a){Object.keys(a).length>0&&(this.isorter.column=a.field,this.isorter.order="ascend"==a.order?"asc":"desc"),this.ipagination=t},getProcessDefByKey:function(t){var e=null,a=JSON.parse(window.sessionStorage.getItem("newestProcessList"));return a.forEach((function(a){a.processKey===t&&(e=a)})),e}}}},a47d:function(t,e,a){"use strict";var n=a("2800"),s=a.n(n);s.a}}]);