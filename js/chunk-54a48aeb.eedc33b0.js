(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-54a48aeb","chunk-2d0df437","chunk-2d0df437"],{"14d9":function(e,t,r){},"1e8c":function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("j-select-biz-component",e._g(e._b({attrs:{value:e.value,name:"角色",displayKey:"roleName",returnKeys:e.returnKeys,listUrl:e.url.list,columns:e.columns,queryParamText:"角色编码"}},"j-select-biz-component",e.$attrs,!1),e.$listeners))},s=[],i=r("b296"),n={name:"JSelectRole",components:{JSelectBizComponent:i["default"]},props:["value"],data:function(){return{returnKeys:["id","roleCode"],url:{list:"/sys/role/list"},columns:[{title:"角色名称",dataIndex:"roleName",align:"center",width:120},{title:"角色编码",dataIndex:"roleCode",align:"center",width:120}]}}},o=n,l=r("2877"),c=Object(l["a"])(o,a,s,!1,null,"4d57a268",null);t["default"]=c.exports},5314:function(e,t,r){"use strict";var a=r("ae44"),s=r.n(a);s.a},"737a":function(e,t,r){"use strict";var a=r("14d9"),s=r.n(a);s.a},"88bc":function(e,t,r){(function(t){var r=1/0,a=9007199254740991,s="[object Arguments]",i="[object Function]",n="[object GeneratorFunction]",o="[object Symbol]",l="object"==typeof t&&t&&t.Object===Object&&t,c="object"==typeof self&&self&&self.Object===Object&&self,u=l||c||Function("return this")();function d(e,t,r){switch(r.length){case 0:return e.call(t);case 1:return e.call(t,r[0]);case 2:return e.call(t,r[0],r[1]);case 3:return e.call(t,r[0],r[1],r[2])}return e.apply(t,r)}function p(e,t){var r=-1,a=e?e.length:0,s=Array(a);while(++r<a)s[r]=t(e[r],r,e);return s}function m(e,t){var r=-1,a=t.length,s=e.length;while(++r<a)e[s+r]=t[r];return e}var f=Object.prototype,h=f.hasOwnProperty,y=f.toString,v=u.Symbol,b=f.propertyIsEnumerable,g=v?v.isConcatSpreadable:void 0,w=Math.max;function x(e,t,r,a,s){var i=-1,n=e.length;r||(r=I),s||(s=[]);while(++i<n){var o=e[i];t>0&&r(o)?t>1?x(o,t-1,r,a,s):m(s,o):a||(s[s.length]=o)}return s}function _(e,t){return e=Object(e),S(e,t,(function(t,r){return r in e}))}function S(e,t,r){var a=-1,s=t.length,i={};while(++a<s){var n=t[a],o=e[n];r(o,n)&&(i[n]=o)}return i}function k(e,t){return t=w(void 0===t?e.length-1:t,0),function(){var r=arguments,a=-1,s=w(r.length-t,0),i=Array(s);while(++a<s)i[a]=r[t+a];a=-1;var n=Array(t+1);while(++a<t)n[a]=r[a];return n[t]=i,d(e,this,n)}}function I(e){return T(e)||j(e)||!!(g&&e&&e[g])}function O(e){if("string"==typeof e||q(e))return e;var t=e+"";return"0"==t&&1/e==-r?"-0":t}function j(e){return N(e)&&h.call(e,"callee")&&(!b.call(e,"callee")||y.call(e)==s)}var T=Array.isArray;function C(e){return null!=e&&F(e.length)&&!D(e)}function N(e){return P(e)&&C(e)}function D(e){var t=$(e)?y.call(e):"";return t==i||t==n}function F(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=a}function $(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function P(e){return!!e&&"object"==typeof e}function q(e){return"symbol"==typeof e||P(e)&&y.call(e)==o}var R=k((function(e,t){return null==e?{}:_(e,p(x(t,1),O))}));e.exports=R}).call(this,r("c8ba"))},"920a":function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("a-card",{attrs:{bordered:!1}},[r("div",{staticClass:"table-page-search-wrapper"},[r("a-form",{attrs:{layout:"inline"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.searchQuery(t)}}},[r("a-row",{attrs:{gutter:24}},[r("a-col",{attrs:{md:6,sm:8}},[r("a-form-item",{attrs:{label:"流程名称"}},[r("a-input",{attrs:{placeholder:"请输入搜索关键词"},model:{value:e.queryParam.lcmc,callback:function(t){e.$set(e.queryParam,"lcmc",t)},expression:"queryParam.lcmc"}})],1)],1),r("a-col",{attrs:{md:6,sm:8}},[r("a-form-item",{attrs:{label:"流程标识"}},[r("a-input",{attrs:{placeholder:"请输入搜索关键词"},model:{value:e.queryParam.lckey,callback:function(t){e.$set(e.queryParam,"lckey",t)},expression:"queryParam.lckey"}})],1)],1),r("a-col",{attrs:{md:6,sm:8}},[r("a-form-item",{attrs:{label:"是否最新"}},[r("a-switch",{attrs:{checkedChildren:"是",unCheckedChildren:"否",defaultChecked:""},model:{value:e.queryParam.zx,callback:function(t){e.$set(e.queryParam,"zx",t)},expression:"queryParam.zx"}})],1)],1),r("span",{staticClass:"table-page-search-submitButtons",staticStyle:{float:"left",overflow:"hidden"}},[r("a-col",{attrs:{md:6,sm:12}},[r("a-button",{staticStyle:{left:"10px"},attrs:{type:"primary",icon:"search"},on:{click:e.searchQuery}},[e._v("查询")]),r("a-button",{staticStyle:{"margin-left":"8px",left:"10px"},attrs:{type:"primary",icon:"reload"},on:{click:e.searchReset}},[e._v("重置")])],1)],1),r("span",{staticClass:"table-page-search-submitButtons",staticStyle:{float:"right",overflow:"hidden"}},[r("a-col",{attrs:{md:12,sm:12}})],1)],1)],1)],1),r("a-table",{ref:"table",attrs:{scroll:{x:2200,y:500},bordered:"",size:"middle",rowKey:"id",dataSource:e.dataSource,pagination:e.ipagination,loading:e.loading},on:{change:e.handleTableChange}},[r("a-table-column",{key:"a",attrs:{title:"#",width:50,fixed:"left"},scopedSlots:e._u([{key:"default",fn:function(t,a,s){return[r("span",[e._v(" "+e._s(s+1)+" ")])]}}])}),r("a-table-column",{attrs:{title:"流程名称",dataIndex:"name",width:200,align:"center",fixed:"left"},scopedSlots:e._u([{key:"default",fn:function(t,a,s){return[r("span",[e._v(" "+e._s(t)+" ")])]}}])}),r("a-table-column",{attrs:{title:"流程标识",dataIndex:"processKey",width:200,align:"center"},scopedSlots:e._u([{key:"default",fn:function(t,a,s){return[r("span",[e._v(" "+e._s(t)+" ")])]}}])}),r("a-table-column",{key:"asa",attrs:{title:"版本",dataIndex:"version",width:100,align:"center",sorter:function(e,t){return e.version-t.version}},scopedSlots:e._u([{key:"default",fn:function(t,a,s){return[r("span",[e._v(" v."+e._s(t)+" ")])]}}])}),r("a-table-column",{key:"categoryId_",attrs:{title:"所属分类",dataIndex:"categoryId",width:200,align:"center",filters:e.lcTypeF},on:{filter:e.filter_categoryId},scopedSlots:e._u([{key:"default",fn:function(t,a,s){return[r("span",[e._v(" "+e._s(e.filterDictText(e.dictOptions,t))+" ")])]}}])}),r("a-table-column",{attrs:{title:"流程图片",dataIndex:"diagramName",width:200,align:"center"},scopedSlots:e._u([{key:"default",fn:function(t,a,s){return[r("span",{staticStyle:{color:"blue",cursor:"pointer"},on:{click:function(t){return e.showResource(a)}}},[e._v(e._s(t))])]}}])}),r("a-table-column",{attrs:{title:"表单路由",dataIndex:"routeName",width:200,align:"center"},scopedSlots:e._u([{key:"default",fn:function(t,a,s){return[r("span",{staticStyle:{color:"blue",cursor:"pointer"},on:{click:function(r){return e.viewForm(t)}}},[e._v(" "+e._s(e.getFormComponent(t).text)+" ")])]}}])}),r("a-table-column",{attrs:{title:"状态",dataIndex:"status",width:200,align:"center"},scopedSlots:e._u([{key:"default",fn:function(t,a,s){return[1==t?r("span",{staticStyle:{color:"#00A0E9"}},[e._v(" 已启用 ")]):e._e(),1!=t?r("span",{staticStyle:{color:"#999"}},[e._v(" 未启用 ")]):e._e()]}}])}),r("a-table-column",{attrs:{title:"备注说明",dataIndex:"description",width:200,align:"center"},scopedSlots:e._u([{key:"default",fn:function(e,t,a){return[r("j-ellipsis",{attrs:{value:e,length:10}})]}}])}),r("a-table-column",{attrs:{title:"部署时间",dataIndex:"createTime",width:200,align:"center"},scopedSlots:e._u([{key:"default",fn:function(t,a,s){return[r("span",[e._v(" "+e._s(t)+" ")])]}}])}),r("a-table-column",{attrs:{title:"更新时间",dataIndex:"updateTime",width:200,align:"center"},scopedSlots:e._u([{key:"default",fn:function(t,a,s){return[r("span",[e._v(" "+e._s(t)+" ")])]}}])}),r("a-table-column",{attrs:{title:"操作",dataIndex:"",align:"center",width:250,fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(t,a,s){return[1!=a.status?r("a",{staticStyle:{color:"rgb(144,96,255)"},attrs:{href:"javascript:void(0);"},on:{click:function(t){return e.editStatus(1,a)}}},[e._v("启用")]):e._e(),1==a.status?r("a",{staticStyle:{color:"#cb892d"},attrs:{href:"javascript:void(0);"},on:{click:function(t){return e.editStatus(0,a)}}},[e._v("禁用")]):e._e(),r("a-divider",{attrs:{type:"vertical"}}),r("a",{attrs:{href:"javascript:void(0);"},on:{click:function(t){return e.getNodeData(a)}}},[e._v("节点设置")]),r("a-divider",{attrs:{type:"vertical"}}),r("a",{attrs:{href:"javascript:void(0);"},on:{click:function(t){return e.convertToModel(a)}}},[e._v("转为模型")]),r("br"),r("a",{attrs:{href:"javascript:void(0);"},on:{click:function(t){return e.edit(a)}}},[e._v("编辑")]),r("a-divider",{attrs:{type:"vertical"}}),r("a",{staticStyle:{color:"red"},attrs:{href:"javascript:void(0);"},on:{click:function(t){return e.remove(a)}}},[e._v("删除")])]}}])})],1),r("a-modal",{attrs:{width:"900px",confirmLoading:e.confirmLoading,title:"编辑流程",visible:e.editObj.visible},on:{ok:e.editObjOk,cancel:function(t){e.editObj.visible=!1}}},[e.editObj.visible?r("a-form",{attrs:{form:e.editForm}},[r("a-form-item",{attrs:{"label-col":e.labelCol,"wrapper-col":e.wrapperCol,label:"流程分类"}},[r(e.LcDict,{directives:[{name:"decorator",rawName:"v-decorator",value:["categoryId",{initialValue:e.editObj.categoryId,rules:[{required:!0,message:"不能为空"}]}],expression:"[ 'categoryId', {initialValue:editObj.categoryId, rules: [{ required: true, message: '不能为空' }] },]"}],tag:"component",attrs:{"trigger-change":!0,placeholder:"请选择流程分类",dictCode:"bpm_process_type"}})],1),r("a-form-item",{attrs:{"label-col":e.labelCol,"wrapper-col":e.wrapperCol,label:"流程类目(app使用)"}},[r("j-tree-dict",{directives:[{name:"decorator",rawName:"v-decorator",value:["typeId",{initialValue:e.editObj.typeId,rules:[{required:!0,message:"不能为空"}]}],expression:"[ 'typeId', {initialValue:editObj.typeId, rules: [{ required: true, message: '不能为空' }] },]"}],attrs:{placeholder:"请选择流程类目",parentCode:"A01","trigger-change":!0}})],1),r("a-form-item",{attrs:{"label-col":e.labelCol,"wrapper-col":e.wrapperCol,label:"关联表单"}},[r("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["routeName",{initialValue:e.editObj.routeName,rules:[{required:!0,message:"不能为空"}]}],expression:"[ 'routeName', {initialValue:editObj.routeName, rules: [{ required: true, message: '不能为空' }] },]"}],attrs:{placeholder:"请选择关联表单","trigger-change":!0},on:{change:e.change_routeName}},[r("a-select-option",{attrs:{value:""}},[e._v("请选择")]),e._l(e.allFormComponent,(function(t,a){return r("a-select-option",{key:t.routeName,attrs:{value:t.routeName}},[r("span",{staticStyle:{display:"inline-block",width:"100%"},attrs:{title:t.text}},[e._v("\n                "+e._s(t.text)+"\n              ")])])}))],2),r("a",{attrs:{href:"javascrip:void(0)"},on:{click:function(t){return e.viewForm()}}},[e._v("预览表单")])],1),r("a-form-item",{attrs:{"label-col":e.labelCol,"wrapper-col":e.wrapperCol,label:"角色授权"}},[r("j-select-role",{directives:[{name:"decorator",rawName:"v-decorator",value:["roles",{initialValue:e.editObj.roles,rules:[]}],expression:"[ 'roles', {initialValue:editObj.roles, rules: []}]"}],attrs:{placeholder:"不选择则所有人可用"}})],1),r("a-form-item",{attrs:{"label-col":e.labelCol,"wrapper-col":e.wrapperCol,label:"排序"}},[r("a-input-number",{directives:[{name:"decorator",rawName:"v-decorator",value:["sort",{initialValue:e.editObj.sort,rules:[]}],expression:"[ 'sort', {initialValue:editObj.sort, rules: []}]"}],attrs:{placeholder:"排序"}})],1),r("a-form-item",{attrs:{"label-col":e.labelCol,"wrapper-col":e.wrapperCol,label:"备注描述"}},[r("a-textarea",{directives:[{name:"decorator",rawName:"v-decorator",value:["description",{initialValue:e.editObj.description,rules:[]}],expression:"[ 'description', {initialValue:editObj.description, rules: []}]"}],attrs:{placeholder:"备注描述",autoSize:{minRows:3,maxRows:5}}})],1)],1):e._e()],1),r("a-modal",{attrs:{title:"编辑流程节点",width:"900px",maskClosable:!1,confirmLoading:e.confirmLoading,visible:e.showProcessNodeEdit,footer:null},on:{cancel:e.closeNode}},[r("a-row",[r("a-col",{staticStyle:{"border-right":"1px solid #999"},attrs:{md:4,sm:4}},[r("a-steps",{attrs:{direction:"vertical",current:e.current,size:"small"}},[e._l(e.nodeList,(function(t,a){return[r("a-step",{staticStyle:{cursor:"pointer"},attrs:{title:t.title,description:t.description,status:a==e.current?"process":"wait"},on:{click:function(r){return e.change_steps(t,a)}}})]}))],2)],1),r("a-col",{attrs:{md:20,sm:20}},[r("a-alert",{attrs:{message:"温馨提示：若流程运行至未分配审批人员的审批节点时，流程将自动中断取消！",banner:""}}),r("span"),e.showProcessNodeEdit?r("a-form",{attrs:{form:e.nodeForm}},[r("a-form-item",{attrs:{"label-col":e.labelCol,"wrapper-col":e.wrapperCol,label:"节点名称"}},[r("span",{staticClass:"nodespan"},[e._v(e._s(e.editNode.title))])]),r("a-form-item",{attrs:{"label-col":e.labelCol,"wrapper-col":e.wrapperCol,label:"节点类型"}},[r("span",{staticClass:"nodespan"},[e._v(e._s(e.dictNodeType[e.editNode.type]))])]),r("a-alert",{attrs:{type:"info",message:"每个节点设置，如有修改都请保存一次，跳转节点后数据不会自动保存！",banner:""}}),r("br"),r("a-form-item",{directives:[{name:"show",rawName:"v-show",value:1==e.editNode.type,expression:"editNode.type==1"}],attrs:{"label-col":e.labelCol,"wrapper-col":e.wrapperCol,label:"审批人员"}},[r("a-checkbox-group",{on:{change:e.spryType},model:{value:e.spryTypes,callback:function(t){e.spryTypes=t},expression:"spryTypes"}},[r("a-checkbox",{attrs:{value:"0"}},[e._v(" 根据角色选择 ")]),r("a-checkbox",{attrs:{value:"1"}},[e._v(" 直接选择人员 ")]),r("a-checkbox",{attrs:{value:"2"}},[e._v(" 部门 ")]),r("a-checkbox",{attrs:{value:"5"}},[e._v(" 部门负责人 ")]),r("a-checkbox",{attrs:{value:"3"}},[e._v("\n                  发起人\n                  "),r("a-tooltip",{attrs:{placement:"topLeft",title:"自动获取发起人"}},[r("a-icon",{attrs:{type:"exclamation-circle"}})],1)],1),r("a-checkbox",{attrs:{value:"4"}},[e._v("\n                  发起人的部门负责人\n                  "),r("a-tooltip",{attrs:{placement:"topLeft",title:"自动获取发起人所在部门的负责人，即其上级领导。（如果其本身就是部门负责人，则指向发起人自己。）"}},[r("a-icon",{attrs:{type:"exclamation-circle"}})],1)],1),r("a-checkbox",{attrs:{value:"6"}},[e._v("\n                  表单变量\n                  "),r("a-tooltip",{attrs:{placement:"topLeft",title:"填写与表单中相对应的变量，role:角色，user:人员：dept:部门：deptManage:部门负责人; 例如：variable:role,variable2:user;"}},[r("a-icon",{attrs:{type:"exclamation-circle"}})],1)],1)],1)],1),e.spryTypes.indexOf("0")>-1?r("a-form-item",{attrs:{"label-col":e.labelCol,"wrapper-col":e.wrapperCol,label:"选择角色"}},[r("j-select-role",{model:{value:e.spry.roleIds,callback:function(t){e.$set(e.spry,"roleIds",t)},expression:"spry.roleIds"}})],1):e._e(),e.spryTypes.indexOf("1")>-1?r("a-form-item",{attrs:{"label-col":e.labelCol,"wrapper-col":e.wrapperCol,label:"选择人员"}},[r("j-select-user-by-dep",{attrs:{multi:!0},model:{value:e.spry.userIds,callback:function(t){e.$set(e.spry,"userIds",t)},expression:"spry.userIds"}})],1):e._e(),e.spryTypes.indexOf("2")>-1?r("a-form-item",{attrs:{"label-col":e.labelCol,"wrapper-col":e.wrapperCol,label:"选择部门"}},[r("j-select-depart",{attrs:{multi:!0},model:{value:e.spry.departmentIds,callback:function(t){e.$set(e.spry,"departmentIds",t)},expression:"spry.departmentIds"}})],1):e._e(),e.spryTypes.indexOf("5")>-1?r("a-form-item",{attrs:{"label-col":e.labelCol,"wrapper-col":e.wrapperCol,label:"选择部门负责人"}},[r("j-select-depart",{attrs:{multi:!0},model:{value:e.spry.departmentManageIds,callback:function(t){e.$set(e.spry,"departmentManageIds",t)},expression:"spry.departmentManageIds"}})],1):e._e(),e.spryTypes.indexOf("6")>-1?r("a-form-item",{attrs:{"label-col":e.labelCol,"wrapper-col":e.wrapperCol,label:"输入表单变量"}},[r("a-input",{attrs:{multi:!0},model:{value:e.spry.formVariables,callback:function(t){e.$set(e.spry,"formVariables",t)},expression:"spry.formVariables"}})],1):e._e(),r("a-form-item",{attrs:{"wrapper-col":{span:12,offset:5}}},[r("a-button",{attrs:{type:"primary","html-type":"submit",disabled:0==e.editNode.type||2==e.editNode.type||e.confirmLoading},on:{click:e.sprySubmit}},[e._v("\n                提交并保存\n              ")]),r("a-button",{staticStyle:{"margin-left":"10px"},on:{click:e.closeNode}},[e._v("\n                关闭\n              ")])],1)],1):e._e()],1)],1)],1),r("a-modal",{attrs:{title:e.viewTitle,width:"90%",visible:e.viewImage,footer:null},on:{cancel:function(t){e.viewImage=!1}}},[r("div",{staticStyle:{"min-height":"400px"}},[r("img",{attrs:{src:e.diagramUrl,alt:e.viewTitle}})])]),r("a-modal",{attrs:{title:e.lcModa.title,footer:null,maskClosable:!1,width:"80%"},model:{value:e.lcModa.visible,callback:function(t){e.$set(e.lcModa,"visible",t)},expression:"lcModa.visible"}},[r(e.lcModa.formComponent,{tag:"component",attrs:{disabled:!0}})],1)],1)},s=[],i=(r("88bc"),r("ca00")),n=r("b65a"),o=r("9ab6"),l=r("d579"),c=r("0fea"),u=r("b098"),d=r("4165"),p=r("89f2"),m=r("c14a"),f=r("1e8c"),h=r("fe54"),y={name:"ProcessModelList",mixins:[o["a"],n["a"]],components:{JEllipsis:l["default"],JSelectUserByDep:m["default"],JSelectRole:f["default"],JSelectDepart:h["default"],JTreeSelect:u["default"],JTreeDict:d["default"]},created:function(){},data:function(){return{reportList:[],viewImage:!1,viewTitle:"",diagramUrl:"",editObj:{visible:!1},editForm:this.$form.createForm(this),description:"已部署模型",queryParam:{createTimeRange:[],keyWord:"",zx:!0},tabKey:"1",labelCol:{xs:{span:4},sm:{span:4}},wrapperCol:{xs:{span:20},sm:{span:20}},confirmLoading:!1,current:0,nodeForm:this.$form.createForm(this),dictOptions:[],nodeList:[],editNode:{},showProcessNodeEdit:!1,dictNodeType:{0:"开始节点",1:"审批节点",2:"结束节点"},spryTypes:[],url:{list:"/activiti_process/listData",img:"/activiti/models/export",updateStatus:"/activiti_process/updateStatus",delByIds:"/activiti_process/delByIds",convertToModel:"/activiti_process/convertToModel",updateInfo:"/activiti_process/updateInfo",getProcessNode:"/activiti_process/getProcessNode",editNodeUser:"/activiti_process/editNodeUser"},spry:{userIds:"",roleIds:"",departmentIds:"",departmentManageIds:"",formVariables:"",chooseSponsor:!1,chooseDepHeader:!1},lcModa:{title:"流程表单预览",visible:!1,formComponent:null},lcTypeF:[],dataList:[],updateRow:{}}},computed:{LcDict:function(){var e=function(){return Promise.resolve().then(r.bind(null,"7b16"))};return e}},methods:{initDictConfig:function(){var e=this;Object(p["d"])("bpm_process_type").then((function(t){if(t.success){var r=[];e.dictOptions=t.result||[];var a=!0,s=!1,i=void 0;try{for(var n,o=e.dictOptions[Symbol.iterator]();!(a=(n=o.next()).done);a=!0){var l=n.value;r.push({text:l.text,value:l.value})}}catch(c){s=!0,i=c}finally{try{a||null==o.return||o.return()}finally{if(s)throw i}}e.lcTypeF=r}}))},filterDictText:function(e,t){if(e instanceof Array){var r=!0,a=!1,s=void 0;try{for(var i,n=e[Symbol.iterator]();!(r=(i=n.next()).done);r=!0){var o=i.value;if(t===o.value)return o.text}}catch(l){a=!0,s=l}finally{try{r||null==n.return||n.return()}finally{if(a)throw s}}}return t},closeNode:function(){this.showProcessNodeEdit=!1,this.current=0,this.spryTypes=[],this.spry={}},change_steps:function(e,t){this.spryTypes=[],this.current=t,this.editNode=e,this.spry.chooseDepHeader=e.chooseDepHeader||!1,this.spry.chooseDepHeader&&this.spryTypes.push("4"),this.spry.chooseSponsor=e.chooseSponsor||!1,this.spry.chooseSponsor&&this.spryTypes.push("3");var r=[],a=!0,s=!1,i=void 0;try{for(var n,o=(e.users||[])[Symbol.iterator]();!(a=(n=o.next()).done);a=!0){var l=n.value;r.push(l.username)}}catch(N){s=!0,i=N}finally{try{a||null==o.return||o.return()}finally{if(s)throw i}}this.spry.userIds=r.join(","),r.length>0&&this.spryTypes.push("1");var c=[],u=!0,d=!1,p=void 0;try{for(var m,f=(e.roles||[])[Symbol.iterator]();!(u=(m=f.next()).done);u=!0){var h=m.value;c.push(h.roleCode)}}catch(N){d=!0,p=N}finally{try{u||null==f.return||f.return()}finally{if(d)throw p}}this.spry.roleIds=c.join(","),c.length>0&&this.spryTypes.push("0");var y=[],v=!0,b=!1,g=void 0;try{for(var w,x=(e.departments||[])[Symbol.iterator]();!(v=(w=x.next()).done);v=!0){var _=w.value;y.push(_.id)}}catch(N){b=!0,g=N}finally{try{v||null==x.return||x.return()}finally{if(b)throw g}}this.spry.departmentIds=y.join(","),y.length>0&&this.spryTypes.push("2");var S=[],k=!0,I=!1,O=void 0;try{for(var j,T=(e.departmentManages||[])[Symbol.iterator]();!(k=(j=T.next()).done);k=!0){var C=j.value;S.push(C.id)}}catch(N){I=!0,O=N}finally{try{k||null==T.return||T.return()}finally{if(I)throw O}}this.spry.departmentManageIds=S.join(","),S.length>0&&this.spryTypes.push("5"),this.spry.formVariables=e.formVariables||"",this.spry.formVariables&&this.spryTypes.push("6")},spryType:function(e){-1==this.spryTypes.indexOf("0")&&(this.spry.roleIds=""),-1==this.spryTypes.indexOf("1")&&(this.spry.userIds=""),-1==this.spryTypes.indexOf("2")&&(this.spry.departmentIds=""),-1==this.spryTypes.indexOf("5")&&(this.spry.departmentManageIds=""),-1==this.spryTypes.indexOf("6")&&(this.spry.formVariable=""),this.spry.chooseSponsor=this.spryTypes.indexOf("3")>-1,this.spry.chooseDepHeader=this.spryTypes.indexOf("4")>-1},sprySubmit:function(){var e=this;0!=this.spryTypes.length?(e.confirmLoading=!0,this.spry.nodeId=this.editNode.id,this.spry.procDefId=this.editNode.procDefId,this.postFormAction(e.url.editNodeUser,this.spry).then((function(t){t.success?(e.$message.success("操作成功"),e.getNodeData(e.updateRow)):e.$message.error(t.message)})).finally((function(){return e.confirmLoading=!1}))):e.$message.error("必须选择审批人！")},getNodeData:function(e){var t=this;t.updateRow=e,t.postFormAction(t.url.getProcessNode,{id:e.id}).then((function(e){e.success?(t.nodeList=e.result||[],t.nodeList.length>0&&(t.editNode=t.nodeList[t.current],t.showProcessNodeEdit=!0)):t.$message.error(e.message)}))},edit:function(e){this.editObj=Object.assign(this.editObj,e),this.editObj.visible=!0},editObjOk:function(){var e=this,t=this;this.editForm.validateFields((function(r,a){if(!r){var s=Object.assign(e.editObj,a);e.confirmLoading=!0,e.postFormAction(e.url.updateInfo,s).then((function(e){e.success?(t.$message.success("操作成功"),t.loadData(),t.editObj.visible=!1):t.$message.error(e.message)})).finally((function(){return t.confirmLoading=!1}))}}))},change_routeName:function(){var e=this;this.$nextTick((function(){var t=e.editForm.getFieldValue("routeName"),r=e.getFormComponent(t);e.editObj.businessTable=r.businessTable,e.editObj.routeName=r.routeName}))},viewForm:function(e){if(e||(e=this.editObj.routeName),e){var t=this.getFormComponent(e);this.lcModa.formComponent=t.component,this.lcModa.title="流程表单预览："+t.text,this.lcModa.visible=!0}else this.$message.warning("请先选择表单！")},convertToModel:function(e){var t=this;this.$confirm({title:"确认转化",content:"您确认要转化流程 "+e.name+" 为模型?",loading:!0,onOk:function(){t.postFormAction("".concat(t.url.convertToModel),{id:e.id}).then((function(e){e.success?setTimeout((function(){t.$message.success("转化成功")}),300):t.$message.error(e.message)}))}})},remove:function(e){var t=this;t.$confirm({title:"确认删除",content:"您确认要删除流程 "+e.name+" ?",loading:!0,onOk:function(){t.postFormAction(t.url.delByIds,{ids:e.id}).then((function(e){e.success?(t.$message.success("操作成功"),t.loadData()):t.$message.error(e.message)}))}})},editStatus:function(e,t){var r=this,a="";a=0==e?"不启用":"启用",this.$confirm({title:"确认"+a+"?",content:"您确认要".concat(a,"流程").concat(t.name,"?"),onOk:function(){var a={status:e,id:t.id};r.postFormAction(r.url.updateStatus,a).then((function(e){e.success?(r.$message.success("操作成功"),r.loadData()):r.$message.error(e.message)}))},onCancel:function(){}})},showResource:function(e){this.viewTitle="流程图片预览("+e.diagramName+")",this.diagramUrl="".concat(window._CONFIG["domianURL"]).concat(this.url.img,"?id=").concat(e.id),this.viewImage=!0},deletelc:function(e,t){var r=this;e&&Object(c["d"])(this.url.delete+t.id).then((function(e){e.success?r.$message.success(e.message):r.$message.error(e.message),r.loadData()}))},handleTableChange:function(e,t,r){Object.keys(r).length>0&&(this.isorter.column=r.field,this.isorter.order="ascend"==r.order?"asc":"desc"),this.ipagination=e},loadData:function(e){var t=this;if(this.url.list){1===e&&(this.ipagination.current=1);var r=this.getQueryParams();this.loading=!0,Object(c["d"])(this.url.list,r).then((function(e){if(e.success){var r=e.result||[];t.dataSource=r,t.dataList=r,t.ipagination.total=r.length}510===e.code&&t.$message.warning(e.message),t.loading=!1}))}else this.$message.error("请设置url.list属性!")},getQueryParams:function(){var e=Object.assign({},this.queryParam,this.isorter);return delete e.createTimeRange,Object(i["d"])(e)},searchReset:function(){var e=this,t=e.queryParam.logType;e.queryParam={},e.queryParam.logType=t,e.loadData(this.ipagination.current)},onDateChange:function(e,t){this.queryParam.createTime_begin=t[0],this.queryParam.createTime_end=t[1]},onDateOk:function(e){},filter_categoryId:function(e,t){return t.categoryId==e}}},v=y,b=(r("737a"),r("2877")),g=Object(b["a"])(v,a,s,!1,null,"6ff0ce22",null);t["default"]=g.exports},"9ab6":function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));r("ca00"),r("0fea");var a=r("2b0e"),s=r("9fb0"),i=r("d579"),n={components:{JEllipsis:i["default"]},data:function(){return{tokenHeader:{"X-Access-Token":a["default"].ls.get(s["a"])}}},computed:{allFormComponent:function(){return[{text:"示例表单",routeName:"@/views/activiti/form/demoForm",component:function(){return r.e("chunk-71797d8a").then(r.bind(null,"c4c0"))},businessTable:"test_demo"}]},historicDetail:function(){return function(){return r.e("chunk-2d0c06ae").then(r.bind(null,"4260"))}}},methods:{getFormComponent:function(e){return _.find(this.allFormComponent,{routeName:e})||{}},millsToTime:function(e){if(!e)return"";var t=e/1e3;if(t<60)return t.toFixed(0)+" 秒";var r=t/60;if(r<60)return r.toFixed(0)+" 分钟";var a=r/60;if(a<24)return a.toFixed(0)+" 小时";var s=a/24;if(s<30)return s.toFixed(0)+" 天";var i=s/30;if(i<12)return i.toFixed(0)+" 个月";var n=i/12;return n.toFixed(0)+" 年"},handleTableChange:function(e,t,r){Object.keys(r).length>0&&(this.isorter.column=r.field,this.isorter.order="ascend"==r.order?"asc":"desc"),this.ipagination=e},getProcessDefByKey:function(e){var t=null,r=JSON.parse(window.sessionStorage.getItem("newestProcessList"));return r.forEach((function(r){r.processKey===e&&(t=r)})),t}}}},a505:function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("j-modal",{staticStyle:{top:"50px"},attrs:{width:e.modalWidth,visible:e.visible,title:e.title,switchFullscreen:"",cancelText:"关闭"},on:{ok:e.handleSubmit,cancel:e.close}},[r("a-row",{staticStyle:{"background-color":"#ececec",padding:"10px",margin:"-10px"},attrs:{gutter:10}},[r("a-col",{attrs:{md:6,sm:24}},[r("a-card",{attrs:{bordered:!1}},[r("a-directory-tree",{attrs:{selectable:"",selectedKeys:e.selectedDepIds,checkStrictly:!0,dropdownStyle:{maxHeight:"200px",overflow:"auto"},treeData:e.departTree,expandAction:!1,expandedKeys:e.expandedKeys},on:{"update:expandedKeys":function(t){e.expandedKeys=t},"update:expanded-keys":function(t){e.expandedKeys=t},select:e.onDepSelect}})],1)],1),r("a-col",{attrs:{md:18,sm:24}},[r("a-card",{attrs:{bordered:!1}},[e._v("\n        用户账号:\n        "),r("a-input-search",{style:{width:"150px",marginBottom:"15px"},attrs:{placeholder:"请输入账号"},on:{search:e.onSearch},model:{value:e.queryParam.username,callback:function(t){e.$set(e.queryParam,"username",t)},expression:"queryParam.username"}}),r("a-button",{staticStyle:{"margin-left":"20px"},attrs:{icon:"redo"},on:{click:function(t){return e.searchReset(1)}}},[e._v("重置")]),r("a-table",{ref:"table",attrs:{scroll:e.scrollTrigger,size:"middle",rowKey:"id",columns:e.columns,dataSource:e.dataSource,pagination:e.ipagination,rowSelection:{selectedRowKeys:e.selectedRowKeys,onChange:e.onSelectChange,type:e.getType},loading:e.loading},on:{change:e.handleTableChange}})],1)],1)],1)],1)},s=[],i=r("a34a"),n=r.n(i),o=r("ca00"),l=r("4ec3");function c(e,t,r,a,s,i,n){try{var o=e[i](n),l=o.value}catch(c){return void r(c)}o.done?t(l):Promise.resolve(l).then(a,s)}function u(e){return function(){var t=this,r=arguments;return new Promise((function(a,s){var i=e.apply(t,r);function n(e){c(i,a,s,n,o,"next",e)}function o(e){c(i,a,s,n,o,"throw",e)}n(void 0)}))}}var d={name:"JSelectUserByDepModal",components:{},props:["modalWidth","multi","userIds"],data:function(){return{queryParam:{username:""},columns:[{title:"用户账号",align:"center",dataIndex:"username"},{title:"用户姓名",align:"center",dataIndex:"realname"},{title:"性别",align:"center",dataIndex:"sex",customRender:function(e){return 1===e?"男":2===e?"女":e}},{title:"手机",align:"center",dataIndex:"phone"},{title:"部门",align:"center",dataIndex:"orgCodeTxt"}],scrollTrigger:{},dataSource:[],selectedRowKeys:[],selectUserRows:[],selectUserIds:[],title:"根据部门选择用户",ipagination:{current:1,pageSize:10,pageSizeOptions:["10","20","30"],showTotal:function(e,t){return t[0]+"-"+t[1]+" 共"+e+"条"},showQuickJumper:!0,showSizeChanger:!0,total:0},isorter:{column:"createTime",order:"desc"},selectedDepIds:[],departTree:[],visible:!1,form:this.$form.createForm(this),loading:!1,expandedKeys:[]}},computed:{getType:function(){return 1==this.multi?"checkbox":"radio"}},watch:{userIds:{immediate:!0,handler:function(){this.initUserNames()}}},created:function(){this.resetScreenSize(),this.loadData()},methods:{initUserNames:function(){var e=this;if(this.userIds){var t=this.userIds.split(",")+",";Object(l["A"])({username:t,pageNo:1,pageSize:t.length}).then((function(t){if(t.success){var r=[],a=[];t.result.records.forEach((function(e){a.push(e["realname"]),r.push(e["id"])})),e.selectedRowKeys=r,e.$emit("initComp",a.join(","))}}))}else this.$emit("initComp","")},loadData:function(){var e=u(n.a.mark((function e(t){var r,a=this;return n.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(1===t&&(this.ipagination.current=1),!(this.selectedDepIds&&this.selectedDepIds.length>0)){e.next=6;break}return e.next=4,this.initQueryUserByDepId(this.selectedDepIds);case 4:e.next=10;break;case 6:return this.loading=!0,r=this.getQueryParams(),e.next=10,Object(l["A"])(r).then((function(e){e.success&&(a.dataSource=e.result.records,a.ipagination.total=e.result.total)})).finally((function(){a.loading=!1}));case 10:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}(),resetScreenSize:function(){var e=document.body.clientWidth;this.scrollTrigger=e<500?{x:800}:{}},showModal:function(){this.visible=!0,this.queryDepartTree(),this.initUserNames(),this.loadData(),this.form.resetFields()},getQueryParams:function(){var e=Object.assign({},this.queryParam,this.isorter);return e.field=this.getQueryField(),e.pageNo=this.ipagination.current,e.pageSize=this.ipagination.pageSize,Object(o["d"])(e)},getQueryField:function(){for(var e="id,",t=0;t<this.columns.length;t++)e+=","+this.columns[t].dataIndex;return e},searchReset:function(e){var t=this;0!==e&&(t.queryParam={},t.loadData(1)),t.selectedRowKeys=[],t.selectUserIds=[],t.selectedDepIds=[]},close:function(){this.searchReset(0),this.visible=!1},handleTableChange:function(e,t,r){Object.keys(r).length>0&&(this.isorter.column=r.field,this.isorter.order="ascend"===r.order?"asc":"desc"),this.ipagination=e,this.loadData()},handleSubmit:function(){var e=this;this.getSelectUserRows(),e.$emit("ok",e.selectUserRows,e.selectUserIds),e.searchReset(0),e.close()},getSelectUserRows:function(e){var t=this.dataSource,r="";this.selectUserRows=[];for(var a=0,s=t.length;a<s;a++)this.selectedRowKeys.includes(t[a].id)&&(this.selectUserRows.push(t[a]),r=r+","+t[a].username);this.selectUserIds=r.substring(1)},onDepSelect:function(e){null!=e[0]&&(this.initQueryUserByDepId(e),this.selectedDepIds[0]!==e[0]&&(this.selectedDepIds=[e[0]]))},onSelectChange:function(e,t){this.selectedRowKeys=e,this.selectionRows=t},onSearch:function(){this.loadData(1)},initQueryUserByDepId:function(e){var t=this;return this.loading=!0,Object(l["N"])({id:e.toString()}).then((function(e){e.success&&(t.dataSource=e.result,t.ipagination.total=e.result.length)})).finally((function(){t.loading=!1}))},queryDepartTree:function(){var e=this;Object(l["D"])().then((function(t){t.success&&(e.departTree=t.result,e.expandedKeys=e.departTree.map((function(e){return e.id})))}))},modalFormOk:function(){this.loadData()}}},p=d,m=(r("5314"),r("2877")),f=Object(m["a"])(p,a,s,!1,null,"1461a8eb",null);t["default"]=f.exports},ae44:function(e,t,r){},c14a:function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("a-input-search",{attrs:{placeholder:"请先选择用户",readOnly:"",unselectable:"on"},on:{search:e.onSearchDepUser},model:{value:e.userNames,callback:function(t){e.userNames=t},expression:"userNames"}},[r("a-button",{attrs:{slot:"enterButton",disabled:e.disabled},slot:"enterButton"},[e._v("选择用户")])],1),r("j-select-user-by-dep-modal",{ref:"selectModal",attrs:{"modal-width":e.modalWidth,multi:e.multi,"user-ids":e.value},on:{ok:e.selectOK,initComp:e.initComp}})],1)},s=[],i=r("a505"),n={name:"JSelectUserByDep",components:{JSelectUserByDepModal:i["default"]},props:{modalWidth:{type:Number,default:1250,required:!1},value:{type:String,required:!1},disabled:{type:Boolean,required:!1,default:!1},multi:{type:Boolean,default:!0,required:!1}},data:function(){return{userIds:"",userNames:""}},mounted:function(){this.userIds=this.value},watch:{value:function(e){this.userIds=e}},model:{prop:"value",event:"change"},methods:{initComp:function(e){this.userNames=e},onSearchDepUser:function(){this.$refs.selectModal.showModal()},selectOK:function(e,t){if(e){var r="",a=!0,s=!1,i=void 0;try{for(var n,o=e[Symbol.iterator]();!(a=(n=o.next()).done);a=!0){var l=n.value;r+=","+l.realname}}catch(c){s=!0,i=c}finally{try{a||null==o.return||o.return()}finally{if(s)throw i}}this.userNames=r.substring(1),this.userIds=t}else this.userNames="",this.userIds="";this.$emit("change",this.userIds)}}},o=n,l=r("2877"),c=Object(l["a"])(o,a,s,!1,null,"bd3f15c8",null);t["default"]=c.exports}}]);