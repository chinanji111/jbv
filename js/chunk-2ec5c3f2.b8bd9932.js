(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2ec5c3f2"],{5226:function(t,e,a){},"6c52":function(t,e,a){"use strict";var s=a("5226"),n=a.n(s);n.a},7734:function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"search"},[a("a-card",[a("div",{staticClass:"table-page-search-wrapper"},[a("a-form",{attrs:{layout:"inline"},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.handleSearch(e)}}},[a("a-row",{attrs:{gutter:24}},[a("a-col",{attrs:{md:6,sm:8}},[a("a-form-item",{attrs:{label:"流程名称",prop:"name"}},[a("a-input",{attrs:{type:"text",placeholder:"请输入",clearable:""},model:{value:t.searchForm.name,callback:function(e){t.$set(t.searchForm,"name",e)},expression:"searchForm.name"}})],1)],1),a("a-col",{attrs:{md:6,sm:8}},[a("a-form-item",{attrs:{label:"标识Key",prop:"name"}},[a("a-input",{attrs:{type:"text",placeholder:"请输入",clearable:""},model:{value:t.searchForm.key,callback:function(e){t.$set(t.searchForm,"key",e)},expression:"searchForm.key"}})],1)],1),a("span",{staticClass:"table-page-search-submitButtons",staticStyle:{float:"left",overflow:"hidden"}},[a("a-col",{attrs:{md:6,sm:12}},[a("a-button",{attrs:{type:"primary",icon:"search"},on:{click:t.handleSearch}},[t._v("搜索")]),a("a-button",{staticStyle:{"margin-left":"10px"},on:{click:t.handleReset}},[t._v("重置")])],1)],1)],1)],1)],1),a("a-row",[a("a-table",{ref:"table",attrs:{scroll:t.scroll,bordered:"",loading:t.loading,rowKey:"id",dataSource:t.data,pagination:t.ipagination},on:{change:t.handleTableChange}},[a("a-table-column",{attrs:{title:"#",width:50},scopedSlots:t._u([{key:"default",fn:function(e,s,n){return[a("span",[t._v(" "+t._s(n+1)+" ")])]}}])}),a("a-table-column",{attrs:{title:"流程实例ID",dataIndex:"id",width:150},scopedSlots:t._u([{key:"default",fn:function(e,s,n){return[a("span",[t._v(" "+t._s(e)+" ")])]}}])}),a("a-table-column",{attrs:{title:"流程名称",dataIndex:"name",width:150},scopedSlots:t._u([{key:"default",fn:function(e,s,n){return[a("span",[t._v(" "+t._s(e)+" ")])]}}])}),a("a-table-column",{attrs:{title:"申请人",dataIndex:"applyer",width:100},scopedSlots:t._u([{key:"default",fn:function(e,s,n){return[a("span",[t._v(" "+t._s(e)+" ")])]}}])}),a("a-table-column",{attrs:{title:"标识Key",dataIndex:"key",width:150},scopedSlots:t._u([{key:"default",fn:function(e,s,n){return[a("span",[t._v(" "+t._s(e)+" ")])]}}])}),a("a-table-column",{attrs:{title:"版本",dataIndex:"version",width:150},scopedSlots:t._u([{key:"default",fn:function(e,s,n){return[a("span",[t._v(" v."+t._s(e)+" ")])]}}])}),a("a-table-column",{attrs:{title:"当前环节",dataIndex:"currTaskName",width:150},scopedSlots:t._u([{key:"default",fn:function(e,s,n){return[a("span",[t._v(" "+t._s(e)+" ")])]}}])}),a("a-table-column",{key:"isSuspended",attrs:{title:"状态",dataIndex:"isSuspended",width:110,sorter:function(t,e){return Boolean(t.isSuspended)||1-Boolean(e.isSuspended)?0:1}},scopedSlots:t._u([{key:"default",fn:function(e,s,n){return[e?a("span",{staticStyle:{color:"red"}},[t._v(" 已挂起 ")]):a("span",{staticStyle:{color:"#2f54eb"}},[t._v(" 已激活 ")])]}}])}),a("a-table-column",{attrs:{title:"操作",dataIndex:"action"},scopedSlots:t._u([{key:"default",fn:function(e,s,n){return[s.isSuspended?[a("a",{staticStyle:{color:"green"},attrs:{href:"javascript:void(0);"},on:{click:function(e){return t.editStatus(1,s)}}},[t._v("激活")]),a("a-divider",{attrs:{type:"vertical"}})]:[a("a",{staticStyle:{color:"orange"},attrs:{href:"javascript:void(0);"},on:{click:function(e){return t.editStatus(0,s)}}},[t._v("挂起")]),a("a-divider",{attrs:{type:"vertical"}})],a("a",{staticStyle:{color:"blue"},attrs:{href:"javascript:void(0);"},on:{click:function(e){return t.history(s)}}},[t._v("审批详情")]),a("a-divider",{attrs:{type:"vertical"}}),a("a",{staticStyle:{color:"#999"},attrs:{href:"javascript:void(0);"},on:{click:function(e){return t.detail(s)}}},[t._v("表单数据")]),a("a-divider",{attrs:{type:"vertical"}}),a("a-popconfirm",{attrs:{title:"确定删除吗?"},on:{confirm:function(){return t.remove(s)}}},[a("a",{staticStyle:{color:"red"}},[t._v("删除")])])]}}])})],1)],1)],1),a("a-modal",{attrs:{title:t.modalTitle,"mask-closable":!1,width:500,styles:{top:"30px"}},model:{value:t.modalVisible,callback:function(e){t.modalVisible=e},expression:"modalVisible"}},[a("a-form",{ref:"form",attrs:{model:t.form,"label-width":70,rules:t.formValidate}},[a("a-form-item",{attrs:{label:"删除原因",prop:"reason"}},[a("a-input",{attrs:{type:"textarea",rows:4},model:{value:t.form.reason,callback:function(e){t.$set(t.form,"reason",e)},expression:"form.reason"}})],1)],1),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("a-button",{attrs:{type:"text"},on:{click:t.handelCancel}},[t._v("取消")]),a("a-button",{attrs:{type:"primary",loading:t.submitLoading},on:{click:t.handelSubmit}},[t._v("提交")])],1)],1),a("a-modal",{attrs:{title:"审批历史","mask-closable":!1,width:"80%",footer:null},model:{value:t.modalLsVisible,callback:function(e){t.modalLsVisible=e},expression:"modalLsVisible"}},[t.modalLsVisible?a("div",[a(t.historicDetail,{tag:"component",attrs:{procInstId:t.procInstId}})],1):t._e()]),a("a-modal",{attrs:{title:t.lcModa.title,footer:null,maskClosable:!1,width:"80%"},model:{value:t.lcModa.visible,callback:function(e){t.$set(t.lcModa,"visible",e)},expression:"lcModa.visible"}},[t.lcModa.visible?a(t.lcModa.formComponent,{tag:"component",attrs:{disabled:t.lcModa.disabled,processData:t.lcModa.processData,isNew:t.lcModa.isNew},on:{close:function(e){t.lcModa.visible=!1,t.lcModa.disabled=!1}}}):t._e()],1)],1)},n=[],o=a("9ab6"),i=a("b65a"),r={mixins:[o["a"],i["a"]],name:"process-ins-manage",data:function(){return{openSearch:!0,openTip:!0,loading:!0,selectCount:0,selectList:[],searchForm:{name:"",key:"",pageNumber:1,pageSize:10},modalType:0,modalVisible:!1,modalTitle:"",form:{reason:""},formValidate:{},submitLoading:!1,data:[],total:0,deleteId:"",url:{getRunningProcess:"/actProcessIns/getRunningProcess",deleteProcessIns:"/actProcessIns/delInsByIds/",updateInsStatus:"/actProcessIns/updateInsStatus/"},modalLsVisible:!1,procInstId:"",lcModa:{title:"",disabled:!1,visible:!1,formComponent:null,isNew:!1}}},methods:{loadData:function(){},init:function(){this.getDataList()},getDataList:function(){var t=this;this.loading=!0,this.getAction(this.url.getRunningProcess,this.searchForm).then((function(e){t.loading=!1,e.success?t.data=e.result:t.$message.error(e.message)}))},handleSearch:function(){this.searchForm.pageNumber=1,this.searchForm.pageSize=10,this.getDataList()},handleReset:function(){this.searchForm={},this.searchForm.pageNumber=1,this.searchForm.pageSize=10,this.getDataList()},handelCancel:function(){this.modalVisible=!1},handelSubmit:function(){var t=this;this.submitLoading=!0,this.postFormAction(this.url.deleteProcessIns+this.deleteId,this.form).then((function(e){t.submitLoading=!1,e.success?(t.$message.success("操作成功"),t.modalVisible=!1,t.getDataList()):t.$message.error(e.message)}))},editStatus:function(t,e){var a=this,s="";s=0==t?"暂停挂起":"激活运行",this.$confirm({title:"确认"+s,content:"您确认要".concat(s,"流程实例").concat(e.name,"?"),loading:!0,onOk:function(){var s={status:t,id:e.id};a.postFormAction(a.url.updateInsStatus,s).then((function(t){t.success?(a.$message.success("操作成功"),a.getDataList()):a.$message.error(t.message)}))}})},detail:function(t){t.routeName?(this.lcModa.disabled=!0,this.lcModa.title="查看流程业务信息："+t.name,this.lcModa.formComponent=this.getFormComponent(t.routeName).component,this.lcModa.processData=t,this.lcModa.isNew=!1,this.lcModa.visible=!0):this.$message.warning("该流程信息未配置表单，请联系开发人员！")},history:function(t){t.procInstId?(this.procInstId=t.procInstId,this.modalLsVisible=!0):this.$message.error("流程实例ID不存在")},remove:function(t){this.modalTitle="确认删除流程 ".concat(t.name),this.deleteId=t.id,this.modalType=0,this.modalVisible=!0},handleTableChange:function(t,e,a){Object.keys(a).length>0&&(this.isorter.column=a.field,this.isorter.order="ascend"==a.order?"asc":"desc"),this.ipagination=t}},mounted:function(){this.init()},watch:{}},l=r,c=(a("6c52"),a("2877")),d=Object(c["a"])(l,s,n,!1,null,null,null);e["default"]=d.exports},"9ab6":function(t,e,a){"use strict";a.d(e,"a",(function(){return i}));a("ca00"),a("0fea");var s=a("2b0e"),n=a("9fb0"),o=a("d579"),i={components:{JEllipsis:o["default"]},data:function(){return{tokenHeader:{"X-Access-Token":s["default"].ls.get(n["a"])}}},computed:{allFormComponent:function(){return[{text:"示例表单",routeName:"@/views/activiti/form/demoForm",component:function(){return a.e("chunk-71797d8a").then(a.bind(null,"c4c0"))},businessTable:"test_demo"}]},historicDetail:function(){return function(){return a.e("chunk-2d0c06ae").then(a.bind(null,"4260"))}}},methods:{getFormComponent:function(t){return _.find(this.allFormComponent,{routeName:t})||{}},millsToTime:function(t){if(!t)return"";var e=t/1e3;if(e<60)return e.toFixed(0)+" 秒";var a=e/60;if(a<60)return a.toFixed(0)+" 分钟";var s=a/60;if(s<24)return s.toFixed(0)+" 小时";var n=s/24;if(n<30)return n.toFixed(0)+" 天";var o=n/30;if(o<12)return o.toFixed(0)+" 个月";var i=o/12;return i.toFixed(0)+" 年"},handleTableChange:function(t,e,a){Object.keys(a).length>0&&(this.isorter.column=a.field,this.isorter.order="ascend"==a.order?"asc":"desc"),this.ipagination=t},getProcessDefByKey:function(t){var e=null,a=JSON.parse(window.sessionStorage.getItem("newestProcessList"));return a.forEach((function(a){a.processKey===t&&(e=a)})),e}}}}}]);